(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7968],{117:(e,t,s)=>{"use strict";s.d(t,{N:()=>r});let r=(0,s(1958).UU)("https://ecfxrmhrfjqdmqewzrfz.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVjZnhybWhyZmpxZG1xZXd6cmZ6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYzNDA0OTgsImV4cCI6MjA4MTkxNjQ5OH0.jtF3Qp9N7rH-KCWEMHU0atH7h-LQEJBKYO9Q2HdxkX0")},2567:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>m});var r=s(5155),a=s(8500),l=s.n(a),n=s(2115),i=s(117);function d(e){let t=Number(e??0);return new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP"}).format(t)}function m(){let[e,t]=(0,n.useState)(!0),[s,a]=(0,n.useState)(null),[m,c]=(0,n.useState)([]);(0,n.useEffect)(()=>{let e=!0;return(async()=>{try{t(!0),a(null);let{data:s,error:r}=await i.N.from("payments").select("id,created_at,method,amount,order_id").order("created_at",{ascending:!1}).limit(200);if(r)throw r;if(!e)return;c(s??[])}catch(t){if(!e)return;a(t?.message||"Failed to load payments (do you have a payments table?)")}finally{e&&t(!1)}})(),()=>{e=!1}},[]);let o=(0,n.useMemo)(()=>{let e={};for(let t of m){let s=String(t.method??"UNKNOWN").toUpperCase();e[s]=(e[s]??0)+Number(t.amount??0)}return e},[m]),x=(0,n.useMemo)(()=>Object.keys(o).sort(),[o]);return(0,r.jsx)("main",{className:"min-h-screen bg-gray-50 text-black",children:(0,r.jsxs)("div",{className:"max-w-6xl mx-auto px-4 py-6",children:[(0,r.jsx)(l(),{href:"/admin",className:"text-sm text-blue-600 hover:underline",children:"← Admin"}),(0,r.jsx)("h1",{className:"text-xl font-semibold mt-2",children:"Payments"}),s?(0,r.jsx)("div",{className:"mt-4 border rounded-2xl p-4 bg-white text-sm text-red-600",children:s}):null,(0,r.jsx)("section",{className:"mt-4 grid grid-cols-2 lg:grid-cols-4 gap-3",children:(e?["…"]:x).map((t,s)=>(0,r.jsxs)("div",{className:"border rounded-2xl p-4 bg-white",children:[(0,r.jsx)("div",{className:"text-xs text-gray-500",children:"Method"}),(0,r.jsx)("div",{className:"mt-1 text-sm font-semibold",children:e?"…":t}),(0,r.jsx)("div",{className:"mt-2 text-lg font-semibold",children:e?"…":d(o[t])})]},t+s))}),(0,r.jsxs)("section",{className:"mt-4 border rounded-2xl bg-white p-4",children:[(0,r.jsx)("div",{className:"font-semibold",children:"Recent payments"}),(0,r.jsx)("div",{className:"mt-3 space-y-2",children:(e?Array.from({length:6}):m.slice(0,30)).map((e,t)=>(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsxs)("span",{className:"text-gray-700",children:[String(e?.method??"…")," ",e?.order_id?`• Order #${e.order_id}`:""]}),(0,r.jsx)("span",{className:"font-semibold",children:d(e?.amount)})]},e?.id??t))})]})]})})}},8341:(e,t,s)=>{Promise.resolve().then(s.bind(s,2567))}},e=>{e.O(0,[8500,1958,8441,3794,7358],()=>e(e.s=8341)),_N_E=e.O()}]);