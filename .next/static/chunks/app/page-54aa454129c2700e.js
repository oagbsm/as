(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8974],{117:(e,t,r)=>{"use strict";r.d(t,{N:()=>a});let a=(0,r(1958).UU)("https://ecfxrmhrfjqdmqewzrfz.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVjZnhybWhyZmpxZG1xZXd6cmZ6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYzNDA0OTgsImV4cCI6MjA4MTkxNjQ5OH0.jtF3Qp9N7rH-KCWEMHU0atH7h-LQEJBKYO9Q2HdxkX0")},541:(e,t,r)=>{Promise.resolve().then(r.bind(r,6919))},6919:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>p});var a=r(5155),i=r(5772),s=r(8500),n=r.n(s),o=r(2115),l=r(8561),c=r(8029),d=r(7270);let u=[{id:1,img:"https://ecfxrmhrfjqdmqewzrfz.supabase.co/storage/v1/object/public/product-images/ads/ad1.webp"},{id:2,img:"https://ecfxrmhrfjqdmqewzrfz.supabase.co/storage/v1/object/public/product-images/ads/ad5.webp"},{id:3,img:"https://ecfxrmhrfjqdmqewzrfz.supabase.co/storage/v1/object/public/product-images/ads/ad3.webp"},{id:4,img:"https://ecfxrmhrfjqdmqewzrfz.supabase.co/storage/v1/object/public/product-images/ads/ad1.webp"}];function m({primary:e,secondary:t,center:r=!0,primaryClass:i="text-[11px] font-medium",secondaryClass:s="text-[9px] text-gray-500"}){return(0,a.jsxs)("div",{className:`${r?"text-center":"text-left"} leading-tight`,children:[(0,a.jsx)("div",{className:i,children:e}),t?(0,a.jsx)("div",{className:s,children:t}):null]})}let f={groceries:"bg-[#0E5C1C]",baby:"bg-[#F8B8D0]","health-beauty":"bg-[#E89A3D]",household:"bg-[#8FC5E8]"};function p(){var e;let t=(0,o.useRef)({}),[r,s]=(0,o.useState)(0),{items:p}=(0,l._)(),{lang:g}=(0,c.o)(),[h,x]=(0,o.useState)([]),[b,w]=(0,o.useState)(!0),[v,y]=(0,o.useState)(null),[j,N]=(0,o.useState)(!1);(0,o.useEffect)(()=>{let e=setInterval(()=>s(e=>(e+1)%u.length),3500);return()=>clearInterval(e)},[]),(0,o.useEffect)(()=>{let e=!0;return(async()=>{try{w(!0);let t=await (0,d.VR)();if(!e)return;x(t)}catch(e){console.error("HOME LOAD CATEGORIES ERROR:",e)}finally{e&&w(!1)}})(),()=>{e=!1}},[]),(0,o.useEffect)(()=>{let e=()=>{N(window.scrollY>140)};return e(),window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[]),(0,o.useEffect)(()=>{if(!h.length)return;let e=new IntersectionObserver(e=>{e.forEach(e=>{let t=e.target.getAttribute("data-cat-slug");t&&e.isIntersecting&&y(t)})},{root:null,rootMargin:"-80px 0px -60% 0px",threshold:.2});return h.forEach(r=>{let a=t.current[r.slug];a&&e.observe(a)}),()=>{e.disconnect()}},[h]);let[_,I]=(0,o.useState)({}),[E,C]=(0,o.useState)({});(0,o.useEffect)(()=>{let e=!0;return(async()=>{let t=Array.isArray(p)?p:[],r=t.map(e=>e.productId),a=t.map(e=>e.variantId).filter(e=>null!=e);try{let[t,i]=await Promise.all([(0,d.ob)(r),(0,d.Cd)(a)]);if(!e)return;let s={};for(let e of t)s[e.id]=e;let n={};for(let e of i)n[e.id]=e;I(s),C(n)}catch(e){console.error(e)}})(),()=>{e=!1}},[p]);let S=(0,o.useMemo)(()=>{let e=Array.isArray(p)?p:[],t=0,r=0;for(let a of e){let e=_[a.productId];if(!e)continue;let i=null!=a.variantId?E[a.variantId]:null;t+=Number(i?.price??e.base_price??0)*(a.qty??1),r+=a.qty??1}return{total:t,count:r}},[p,_,E]);return(0,a.jsxs)("main",{className:"min-h-screen bg-white text-black",children:[h.length>0&&(0,a.jsxs)("section",{className:"sticky top-[110px] z-40 border-b bg-white shadow-sm",children:["          ",(0,a.jsx)("div",{className:"mx-auto max-w-md px-2 py-2 flex gap-4 overflow-x-auto",children:h.map(e=>{let r="en"===g?e.name_en:e.name_so,s="string"==typeof e.img&&e.img.trim().length>0?e.img.trimEnd():"/example.png",n=v===e.slug;return(0,a.jsxs)("button",{onClick:()=>(e=>{let r=t.current[e];if(!r)return;let a=r.getBoundingClientRect(),i=window.scrollY+a.top-170;window.scrollTo({top:i,behavior:"smooth"})})(e.slug),className:`min-w-[78px] px-1 py-0.5 rounded-xl transition-all duration-200 ${n?"bg-[#E3F2FF] shadow-md scale-[1.02]":"bg-transparent"}`,type:"button",children:[!j&&(0,a.jsx)("div",{className:`mx-auto h-14 w-14 pt-[-10px] ounded-full overflow-hidden flex items-center justify-center transition-shadow ${n?"bg-[#DBEAFE] ring-2 ring-[#0B6EA9] shadow-lg":"bg-blue-50"}`,children:(0,a.jsx)(i.default,{src:s,alt:r,width:56,height:56,className:"w-full h-full object-contain p-1"})}),(0,a.jsx)("div",{className:`mt-1 text-[11px] text-center leading-tight font-semibold transition-colors ${n?"text-[#0B6EA9]":"text-[#0B3C6E]"}`,children:r})]},e.id)})})]}),(0,a.jsx)("section",{className:"bg-white pt-0",children:(0,a.jsx)("div",{className:"relative overflow-hidden rounded-2xl bg-white h-[140px] w-[90%] mx-auto",children:(0,a.jsx)("div",{className:"flex transition-transform duration-500",style:{transform:`translateX(-${100*r}%)`},children:u.map(e=>(0,a.jsx)("div",{className:"flex-none w-full h-[140px] flex items-center justify-center bg-white",children:(0,a.jsx)(i.default,{src:e.img,alt:"promo",width:500,height:140,className:"max-h-full w-full object-contain"})},e.id))})})}),(0,a.jsx)("section",{className:"bg-white px-4 pt-0 -mt-2",children:(0,a.jsx)("div",{className:"relative",children:(0,a.jsx)("div",{className:"flex gap-2 overflow-x-auto pb-1 snap-x snap-mandatory",children:["https://ecfxrmhrfjqdmqewzrfz.supabase.co/storage/v1/object/public/product-images/ads/bar1.webp","https://ecfxrmhrfjqdmqewzrfz.supabase.co/storage/v1/object/public/product-images/ads/bar2.webp","https://ecfxrmhrfjqdmqewzrfz.supabase.co/storage/v1/object/public/product-images/ads/bar3.webp","https://ecfxrmhrfjqdmqewzrfz.supabase.co/storage/v1/object/public/product-images/ads/bar4.webp"].map((e,t)=>(0,a.jsx)("div",{className:"min-w-[100px] h-[140px] rounded-2xl overflow-hidden bg-white shadow-sm flex-shrink-0 snap-start border border-gray-200",children:(0,a.jsx)(i.default,{src:e,alt:"promo",width:100,height:140,className:"w-full h-full object-cover"})},t))})})}),(0,a.jsx)("section",{className:"bg-white px-3 pb-6 pt-1",children:h.map(e=>{let r="en"===g?e.name_en:e.name_so;return(0,a.jsxs)("div",{ref:r=>{t.current[e.slug]=r},"data-cat-slug":e.slug,className:"scroll-mt-[140px] pb-3",children:[(0,a.jsx)("div",{className:"mb-1",children:(0,a.jsx)(m,{primary:r,center:!1,primaryClass:"text-lg font-bold text-gray-900"})}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-x-3 gap-y-2.5",children:(e.subcats||[]).slice(0,8).map(t=>{var r;let s="en"===g?t.name_en:t.name_so;return(0,a.jsxs)(n(),{href:`/subcategory/${t.slug}`,className:"flex flex-col items-center",children:[(0,a.jsx)("div",{className:`relative h-[90px] w-[90px] rounded-2xl overflow-hidden flex items-center justify-center ${!(r=e.slug)?"bg-[#F3F4F6]":f[r]??"bg-[#F3F4F6]"}`,children:(0,a.jsx)(i.default,{src:"string"==typeof t.img&&t.img.trim().length>0?t.img.trimEnd():"/example.png",alt:s,fill:!0,className:"object-contain"})}),(0,a.jsx)("div",{className:"mt-0.5",children:(0,a.jsx)(m,{primary:s,primaryClass:"text-[12px] font-semibold text-gray-800"})})]},t.id)})})]},e.id)})}),S.count>0&&(0,a.jsx)("div",{className:"fixed left-0 right-0 bottom-16 z-40",children:(0,a.jsx)("div",{className:"mx-auto max-w-md px-3",children:(0,a.jsxs)(n(),{href:"/cart",className:"flex items-center justify-between bg-[#0B6EA9] text-white rounded-2xl px-4 py-3 shadow-lg",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-xs opacity-90",children:[S.count," item",S.count>1?"s":""," in cart"]}),(0,a.jsx)("div",{className:"text-lg font-extrabold",children:(e=S.total,`₹${Number(e??0).toFixed(0)}`)})]}),(0,a.jsx)("div",{className:"text-right leading-tight font-extrabold",children:(0,a.jsx)("div",{children:"en"===g?"Go to Cart →":"U gudub Gaadhiga →"})})]})})})]})}},7270:(e,t,r)=>{"use strict";r.d(t,{Cd:()=>g,HZ:()=>y,J:()=>m,TW:()=>x,Tl:()=>f,VR:()=>s,Xo:()=>c,cg:()=>w,dC:()=>u,eN:()=>l,fS:()=>v,hB:()=>d,iV:()=>n,ii:()=>o,lN:()=>i,lv:()=>b,ob:()=>p,wR:()=>h});var a=r(117);function i(e){let t=String(e??"").trim();return t&&(t.startsWith("/")||t.startsWith("http://")||t.startsWith("https://"))?t:"/example.png"}async function s(){let{data:e,error:t}=await a.N.from("categories").select("id,slug,img,name_so,name_en").order("id",{ascending:!0});if(t)throw t;let{data:r,error:i}=await a.N.from("subcategories").select("id,category_id,slug,img,name_so,name_en").order("id",{ascending:!0});if(i)throw i;let s=r??[];return(e??[]).map(e=>({...e,subcats:s.filter(t=>t.category_id===e.id)}))}async function n(){let{data:e,error:t}=await a.N.from("categories").select("*").order("id");if(t)throw t;return e??[]}async function o(){let{data:e,error:t}=await a.N.from("subcategories").select("*").order("id");if(t)throw t;return e??[]}async function l(){let{data:e,error:t}=await a.N.from("products").select("*").order("id");if(t)throw t;return e??[]}async function c(){let{data:e,error:t}=await a.N.from("product_variants").select("*").order("id");if(t)throw t;return e??[]}async function d(){let{data:e,error:t}=await a.N.from("product_images").select("*").order("is_primary",{ascending:!1});if(t)throw t;return e??[]}async function u(e){let{data:t,error:r}=await a.N.from("subcategories").select("*").eq("slug",e).maybeSingle();if(r)throw console.error("fetchSubcategoryBySlug error:",{slug:e,error:r}),r;return t}async function m(e){let{data:t,error:r}=await a.N.from("products").select("*").eq("subcategory_id",e).order("id",{ascending:!0});if(r)throw r;return t??[]}async function f(e){let{data:t,error:r}=await a.N.from("subsubcategories").select("*").eq("subcategory_id",e).order("id",{ascending:!0});return r?[]:t??[]}async function p(e){let t=Array.from(new Set(e)).filter(Boolean);if(0===t.length)return[];let{data:r,error:i}=await a.N.from("products").select("id,name,slug,long_description,category_id,subcategory_id,brand_id,is_discounted,base_price,tags,is_active").in("id",t);if(i)throw i;return r??[]}async function g(e){let t=Array.from(new Set(e)).filter(e=>null!=e);if(0===t.length)return[];let{data:r,error:i}=await a.N.from("product_variants").select("id,product_id,label,price,stock").in("id",t);if(i)throw i;return r??[]}async function h(e){return p(e)}async function x(e){let t=Array.from(new Set(e)).filter(Boolean);if(0===t.length)return[];let{data:r,error:i}=await a.N.from("product_variants").select("*").in("product_id",t).order("price",{ascending:!0});if(i)throw i;return r??[]}async function b(e){let t=Array.from(new Set(e)).filter(Boolean);if(0===t.length)return[];let{data:r,error:i}=await a.N.from("product_images").select("*").in("product_id",t).order("is_primary",{ascending:!1});if(i)throw i;return r??[]}async function w(e){let t=e.trim();if(!t)return[];let{data:r,error:i}=await a.N.from("customers").select("id,name,phone").or(`name.ilike.%${t}%,phone.ilike.%${t}%`).limit(8);if(i)throw i;return r??[]}async function v(e){let{data:t,error:r}=await a.N.from("orders").insert({customer_id:e.customer_id,delivery_name:e.delivery.name,delivery_phone:e.delivery.phone,delivery_address:e.delivery.address,delivery_note:e.delivery.note??null,total_amount:e.total_amount,status:"PENDING"}).select("id").single();if(r)throw r;return t}async function y(e,t){let r=t.map(t=>({order_id:e,product_id:t.productId,variant_id:t.variantId,quantity:t.qty,price_at_purchase:t.priceAtPurchase})),{error:i}=await a.N.from("order_items").insert(r);if(i)throw console.log("ORDER_ITEMS_INSERT_ERROR",i),i}},8029:(e,t,r)=>{"use strict";r.d(t,{LanguageProvider:()=>l,o:()=>c});var a=r(5155),i=r(2115);let s=(0,i.createContext)(null),n="lang_v1",o="lang";function l({children:e}){let[t,r]=(0,i.useState)("so");return(0,i.useEffect)(()=>{let e=function(e){if("undefined"==typeof document)return"";let t=document.cookie.match(RegExp("(^| )"+e+"=([^;]+)"));return t?decodeURIComponent(t[2]):""}(o)||null,t=localStorage.getItem(n)||null;r(e||t||"so")},[]),(0,a.jsx)(s.Provider,{value:{lang:t,setLang:e=>{r(e),localStorage.setItem(n,e),function(e,t,r=365){let a=new Date;a.setTime(a.getTime()+24*r*36e5),document.cookie=`${e}=${encodeURIComponent(t)}; expires=${a.toUTCString()}; path=/`}(o,e)}},children:e})}function c(){let e=(0,i.useContext)(s);if(!e)throw Error("useLanguage must be used within LanguageProvider");return e}},8561:(e,t,r)=>{"use strict";r.d(t,{CartProvider:()=>n,_:()=>o});var a=r(5155),i=r(2115);let s=(0,i.createContext)(null);function n({children:e}){let[t,r]=(0,i.useState)([]);function n(e,t){r(r=>r.filter(r=>r.productId!==e||r.variantId!==t))}return(0,i.useEffect)(()=>{let e=localStorage.getItem("cart");e&&r(JSON.parse(e))},[]),(0,i.useEffect)(()=>{localStorage.setItem("cart",JSON.stringify(t))},[t]),(0,a.jsx)(s.Provider,{value:{items:t,addItem:function(e,t,a=1){r(r=>r.find(r=>r.productId===e&&r.variantId===t)?r.map(r=>r.productId===e&&r.variantId===t?{...r,qty:r.qty+a}:r):[...r,{productId:e,variantId:t,qty:a}])},setQty:function(e,t,a){a<=0?n(e,t):r(r=>r.map(r=>r.productId===e&&r.variantId===t?{...r,qty:a}:r))},removeItem:n,clearCart:function(){r([])}},children:e})}function o(){let e=(0,i.useContext)(s);if(!e)throw Error("useCart must be used inside CartProvider");return e}}},e=>{e.O(0,[8500,1958,5772,8441,3794,7358],()=>e(e.s=541)),_N_E=e.O()}]);