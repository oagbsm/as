(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3075],{117:(e,t,r)=>{"use strict";r.d(t,{N:()=>s});let s=(0,r(1958).UU)("https://ecfxrmhrfjqdmqewzrfz.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVjZnhybWhyZmpxZG1xZXd6cmZ6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYzNDA0OTgsImV4cCI6MjA4MTkxNjQ5OH0.jtF3Qp9N7rH-KCWEMHU0atH7h-LQEJBKYO9Q2HdxkX0")},1074:(e,t,r)=>{Promise.resolve().then(r.bind(r,4144))},3321:(e,t,r)=>{"use strict";var s=r(4645);r.o(s,"useParams")&&r.d(t,{useParams:function(){return s.useParams}}),r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})},4144:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u});var s=r(5155),n=r(5175),i=r(3321),a=r(8500),o=r.n(a),l=r(5772),c=r(2115),d=r(7270);function u(){let{tag:e}=(0,i.useParams)(),t=decodeURIComponent(e).trim().toLowerCase(),[r,a]=(0,c.useState)([]),[u,m]=(0,c.useState)([]),[f,h]=(0,c.useState)([]),[p,x]=(0,c.useState)(!0);(0,c.useEffect)(()=>{(async()=>{try{let[e,t,r]=await Promise.all([(0,d.eN)(),(0,d.Xo)(),(0,d.hB)()]);a(e),h(t),m(r)}finally{x(!1)}})()},[t]);let g=(0,c.useMemo)(()=>t?r.filter(e=>(Array.isArray(e.tags)?e.tags.map(e=>String(e).toLowerCase().trim()):[]).includes(t)):[],[r,t]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.A,{}),(0,s.jsxs)("main",{className:"max-w-md mx-auto p-4 bg-white min-h-screen text-[#0B6EA9] flex flex-col gap-4",children:[(0,s.jsxs)("h2",{className:"text-lg font-semibold",children:["Results for: ",(0,s.jsxs)("span",{className:"font-bold",children:['"',t,'"']})]}),p&&(0,s.jsx)("div",{className:"mt-10 text-center text-base",children:"Loading products…"}),!p&&0===g.length&&(0,s.jsxs)("div",{className:"text-center mt-8 text-base",children:["No results found.",(0,s.jsx)("br",{}),(0,s.jsx)("a",{href:"https://wa.me/252622073874",className:"underline font-bold text-[#0B6EA9]",children:"Contact us on WhatsApp \uD83D\uDCE9"})]}),!p&&g.length>0&&(0,s.jsx)("section",{className:"grid grid-cols-2 gap-4",children:g.map(e=>{var t;let r,n,i=(t=e.id,r=u.find(e=>e.product_id===t&&e.is_primary),n=u.find(e=>e.product_id===t),(0,d.lN)(r?.url||n?.url||"/example.png")),{price:a,mrp:c}=function(e,t){let r=f.filter(t=>t.product_id===e);if(0===r.length)return{price:t??0,mrp:null};let s=r.reduce((e,t)=>t.price<e.price?t:e,r[0]);return{price:s.price,mrp:s.mrp??null}}(e.id,e.base_price);return(0,s.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm p-2 flex flex-col gap-2",children:[(0,s.jsxs)(o(),{href:`/product/${e.slug}`,className:"block",children:[(0,s.jsx)("div",{className:"relative",children:(0,s.jsx)(l.default,{src:i,alt:e.name,width:200,height:200,className:"object-contain w-full h-40 rounded-lg bg-white"})}),(0,s.jsx)("p",{className:"mt-2 text-sm font-medium line-clamp-2",children:e.name}),(0,s.jsxs)("div",{className:"mt-1 flex items-center gap-2",children:[(0,s.jsxs)("span",{className:"font-bold text-md",children:[a??"—"," SOS"]}),c&&(0,s.jsxs)("span",{className:"text-xs line-through text-gray-400",children:[c," SOS"]})]})]}),(0,s.jsx)("button",{onClick:()=>window.dispatchEvent(new CustomEvent("cart:add",{detail:{productId:e.id}})),className:"w-full bg-[#0B6EA9] text-white rounded-full py-2 mt-auto",children:"+ Add to Cart"})]},e.id)})})]})]})}},5175:(e,t,r)=>{"use strict";r.d(t,{A:()=>d});var s=r(5155),n=r(3321),i=r(8500),a=r.n(i);function o({placeholder:e="50,000+ items"}){return(0,s.jsxs)(a(),{href:"/search",className:"flex items-center w-full h-11 rounded-full bg-white px-4 gap-3 text-sm text-[#0B6EA9] shadow-md border border-[#DDEAF3] active:scale-[0.98] transition-all",style:{fontSize:"14px"},children:[(0,s.jsx)("div",{className:"h-8 w-8 rounded-full bg-[#0B6EA9] flex items-center justify-center text-white text-[12px] font-bold shadow-sm",children:"\uD83D\uDED2"}),(0,s.jsxs)("span",{className:"flex-1 truncate text-[14px] text-[#0B6EA9]/70 font-medium leading-snug",children:["Search for ",(0,s.jsx)("span",{className:"font-semibold text-[#0B6EA9]",children:e})]}),(0,s.jsx)("span",{className:"text-[#0B6EA9] text-xl",children:"\uD83D\uDD0E"})]})}var l=r(8029);function c(e,t,r=365){let s=new Date(Date.now()+864e5*r).toUTCString();document.cookie=`${e}=${encodeURIComponent(t)}; expires=${s}; path=/`}function d(){let e=(0,n.usePathname)()||"/",t=(0,n.useRouter)(),r="/search"===e,{lang:i,setLang:a}=(0,l.o)(),d="/"!==e&&(e.startsWith("/product")||e.startsWith("/subcategory")||r);return(0,s.jsx)("header",{className:"sticky top-0 z-50 bg-gradient-to-b from-[#A4D8F5] via-[#6BBCE9] to-[#2A99D9]",children:(0,s.jsxs)("div",{className:"mx-auto max-w-md px-2 pt-1 pb-1",children:[(0,s.jsx)("div",{className:"flex justify-end mb-1",children:(0,s.jsxs)("div",{className:"flex bg-white/30 backdrop-blur-sm rounded-full px-2 py-1 gap-1 border border-white/40 shadow-sm",children:[(0,s.jsx)("button",{onClick:()=>{a("so"),c("lang","so")},className:`px-2 py-0.5 rounded-full transition flex items-center justify-center ${"so"===i?"bg-white text-[#39A3E6] shadow":"text-white/90"}`,children:"\uD83C\uDDF8\uD83C\uDDF4"}),(0,s.jsx)("button",{onClick:()=>{a("en"),c("lang","en")},className:`px-2 py-0.5 rounded-full transition flex items-center justify-center ${"en"===i?"bg-white text-[#39A3E6] shadow":"text-white/90"}`,children:"\uD83C\uDDEC\uD83C\uDDE7"})]})}),(0,s.jsxs)("div",{className:"flex items-center gap-2 bg-white rounded-full px-2.5 py-1.5 shadow-md",children:[d&&(0,s.jsx)("button",{onClick:()=>window.history.length>1?t.back():t.push("/"),className:"h-9 w-9 rounded-full bg-[#39A3E6] text-white grid place-items-center shadow","aria-label":"Back",children:"←"}),!r&&(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)(o,{placeholder:"50,000+"})})]})]})})}},7270:(e,t,r)=>{"use strict";r.d(t,{Cd:()=>p,HZ:()=>b,J:()=>m,TW:()=>g,Tl:()=>f,VR:()=>i,Xo:()=>c,cg:()=>y,dC:()=>u,eN:()=>l,fS:()=>N,hB:()=>d,iV:()=>a,ii:()=>o,lN:()=>n,lv:()=>w,ob:()=>h,wR:()=>x});var s=r(117);function n(e){let t=String(e??"").trim();return t&&(t.startsWith("/")||t.startsWith("http://")||t.startsWith("https://"))?t:"/example.png"}async function i(){let{data:e,error:t}=await s.N.from("categories").select("id,slug,img,name_so,name_en").order("id",{ascending:!0});if(t)throw t;let{data:r,error:n}=await s.N.from("subcategories").select("id,category_id,slug,img,name_so,name_en").order("id",{ascending:!0});if(n)throw n;let i=r??[];return(e??[]).map(e=>({...e,subcats:i.filter(t=>t.category_id===e.id)}))}async function a(){let{data:e,error:t}=await s.N.from("categories").select("*").order("id");if(t)throw t;return e??[]}async function o(){let{data:e,error:t}=await s.N.from("subcategories").select("*").order("id");if(t)throw t;return e??[]}async function l(){let{data:e,error:t}=await s.N.from("products").select("*").order("id");if(t)throw t;return e??[]}async function c(){let{data:e,error:t}=await s.N.from("product_variants").select("*").order("id");if(t)throw t;return e??[]}async function d(){let{data:e,error:t}=await s.N.from("product_images").select("*").order("is_primary",{ascending:!1});if(t)throw t;return e??[]}async function u(e){let{data:t,error:r}=await s.N.from("subcategories").select("*").eq("slug",e).maybeSingle();if(r)throw console.error("fetchSubcategoryBySlug error:",{slug:e,error:r}),r;return t}async function m(e){let{data:t,error:r}=await s.N.from("products").select("*").eq("subcategory_id",e).order("id",{ascending:!0});if(r)throw r;return t??[]}async function f(e){let{data:t,error:r}=await s.N.from("subsubcategories").select("*").eq("subcategory_id",e).order("id",{ascending:!0});return r?[]:t??[]}async function h(e){let t=Array.from(new Set(e)).filter(Boolean);if(0===t.length)return[];let{data:r,error:n}=await s.N.from("products").select("id,name,slug,long_description,category_id,subcategory_id,brand_id,is_discounted,base_price,tags,is_active").in("id",t);if(n)throw n;return r??[]}async function p(e){let t=Array.from(new Set(e)).filter(e=>null!=e);if(0===t.length)return[];let{data:r,error:n}=await s.N.from("product_variants").select("id,product_id,label,price,stock").in("id",t);if(n)throw n;return r??[]}async function x(e){return h(e)}async function g(e){let t=Array.from(new Set(e)).filter(Boolean);if(0===t.length)return[];let{data:r,error:n}=await s.N.from("product_variants").select("*").in("product_id",t).order("price",{ascending:!0});if(n)throw n;return r??[]}async function w(e){let t=Array.from(new Set(e)).filter(Boolean);if(0===t.length)return[];let{data:r,error:n}=await s.N.from("product_images").select("*").in("product_id",t).order("is_primary",{ascending:!1});if(n)throw n;return r??[]}async function y(e){let t=e.trim();if(!t)return[];let{data:r,error:n}=await s.N.from("customers").select("id,name,phone").or(`name.ilike.%${t}%,phone.ilike.%${t}%`).limit(8);if(n)throw n;return r??[]}async function N(e){let{data:t,error:r}=await s.N.from("orders").insert({customer_id:e.customer_id,delivery_name:e.delivery.name,delivery_phone:e.delivery.phone,delivery_address:e.delivery.address,delivery_note:e.delivery.note??null,total_amount:e.total_amount,status:"PENDING"}).select("id").single();if(r)throw r;return t}async function b(e,t){let r=t.map(t=>({order_id:e,product_id:t.productId,variant_id:t.variantId,quantity:t.qty,price_at_purchase:t.priceAtPurchase})),{error:n}=await s.N.from("order_items").insert(r);if(n)throw console.log("ORDER_ITEMS_INSERT_ERROR",n),n}},8029:(e,t,r)=>{"use strict";r.d(t,{LanguageProvider:()=>l,o:()=>c});var s=r(5155),n=r(2115);let i=(0,n.createContext)(null),a="lang_v1",o="lang";function l({children:e}){let[t,r]=(0,n.useState)("so");return(0,n.useEffect)(()=>{let e=function(e){if("undefined"==typeof document)return"";let t=document.cookie.match(RegExp("(^| )"+e+"=([^;]+)"));return t?decodeURIComponent(t[2]):""}(o)||null,t=localStorage.getItem(a)||null;r(e||t||"so")},[]),(0,s.jsx)(i.Provider,{value:{lang:t,setLang:e=>{r(e),localStorage.setItem(a,e),function(e,t,r=365){let s=new Date;s.setTime(s.getTime()+24*r*36e5),document.cookie=`${e}=${encodeURIComponent(t)}; expires=${s.toUTCString()}; path=/`}(o,e)}},children:e})}function c(){let e=(0,n.useContext)(i);if(!e)throw Error("useLanguage must be used within LanguageProvider");return e}}},e=>{e.O(0,[8500,1958,5772,8441,3794,7358],()=>e(e.s=1074)),_N_E=e.O()}]);