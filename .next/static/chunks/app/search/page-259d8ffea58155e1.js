(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2959],{117:(e,t,r)=>{"use strict";r.d(t,{N:()=>a});let a=(0,r(1958).UU)("https://ecfxrmhrfjqdmqewzrfz.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVjZnhybWhyZmpxZG1xZXd6cmZ6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYzNDA0OTgsImV4cCI6MjA4MTkxNjQ5OH0.jtF3Qp9N7rH-KCWEMHU0atH7h-LQEJBKYO9Q2HdxkX0")},368:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>g});var a=r(5155),s=r(8500),n=r.n(s),i=r(5772),l=r(2115),c=r(7187),d=r(8029),o=r(7270);let u="recent_searches_v1";function m(){try{return JSON.parse(localStorage.getItem(u)||"[]")}catch{return[]}}function x(e){return String(e??"").toLowerCase().trim().replace(/[-_]+/g," ").replace(/\s+/g," ")}function h(e){return`₹${Number(e??0).toFixed(0)}`}function f(e,t){let r=e?.name_so??e?.name??"",a=e?.name_en??e?.name??"";return"en"===t?a:r}function g(){let{lang:e}=(0,d.o)(),t=(0,l.useRef)(null),[r,s]=(0,l.useState)(""),[g,p]=(0,l.useState)([]),[y,N]=(0,l.useState)([]),[b,j]=(0,l.useState)([]),[w,v]=(0,l.useState)([]),[_,I]=(0,l.useState)([]),[k,S]=(0,l.useState)([]);(0,l.useEffect)(()=>{p(m()),setTimeout(()=>t.current?.focus(),50),(async()=>{let[e,t,r,a,s]=await Promise.all([(0,o.iV)(),(0,o.ii)(),(0,o.eN)(),(0,o.Xo)(),(0,o.hB)()]);N(e),j(t),v(r),I(a),S(s)})()},[]);let C=x(r);function E(e){let t=k.find(t=>t.product_id===e&&t.is_primary),r=k.find(t=>t.product_id===e);return(0,o.lN)(t?.url||r?.url||"/example.png")}function A(e,t){let r=_.filter(t=>t.product_id===e);if(0===r.length)return{price:t??0,mrp:null};let a=r.reduce((e,t)=>t.price<e.price?t:e,r[0]);return{price:a.price,mrp:a.mrp??null}}let R=(0,l.useMemo)(()=>{if(!C)return[];let e=w.map(e=>{let t=y.find(t=>t.id===e.category_id),r=b.find(t=>t.id===e.subcategory_id),a=x(`${t?.name_so??""} ${t?.name_en??""} ${r?.name_so??""} ${r?.name_en??""}`),s=function(e,t){let r=x(e);if(!r)return 0;let a=r.split(" ").filter(Boolean),s=x(t.name),n=x(t.slug),i=x(t.long_description),l=Array.isArray(t.tags)?t.tags.map(x).join(" "):"";if(s===r)return 1e3;if(n===r)return 950;let c=0;for(let e of a)s.includes(e)&&(c+=150),n.includes(e)&&(c+=90),l.includes(e)&&(c+=120),i.includes(e)&&(c+=20);return a[0]&&s.startsWith(a[0])&&(c+=60),c}(C,e)+30*!!C.split(" ").filter(Boolean).some(e=>a.includes(e));return s>0?{p:e,s}:null}).filter(Boolean);return e.sort((e,t)=>t.s-e.s),e.slice(0,30).map(e=>e.p)},[C,w,y,b]),B=(0,l.useMemo)(()=>y.slice(0,8),[y]),$=(0,l.useMemo)(()=>b.slice(0,14),[b]),O=(0,l.useMemo)(()=>w.slice(0,10),[w]);return(0,a.jsxs)("main",{className:"min-h-screen bg-white text-black pb-24",children:[(0,a.jsx)("section",{className:"mx-auto max-w-md px-4 pt-4",children:(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),r.trim()&&(!function(e){let t=e.trim();if(!t)return;let r=[t,...m().filter(e=>e.toLowerCase()!==t.toLowerCase())].slice(0,10);localStorage.setItem(u,JSON.stringify(r))}(r),p(m()))},className:"flex items-center gap-2",children:[(0,a.jsxs)("div",{className:"flex-1 h-11 rounded-full border bg-white px-4 flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"\uD83D\uDD0E"}),(0,a.jsx)("input",{ref:t,value:r,onChange:e=>s(e.target.value),placeholder:"en"===e?"Search products & brands":"Raadi alaab & summado",className:"flex-1 outline-none text-sm"}),r?(0,a.jsx)("button",{type:"button",onClick:()=>s(""),className:"text-gray-500 px-2",children:"✕"}):null]}),(0,a.jsx)("button",{type:"submit",className:"h-11 px-4 rounded-full bg-[#0B6EA9] text-white font-extrabold text-sm",children:"en"===e?"Search":"Raadi"})]})}),C?(0,a.jsxs)("section",{className:"mx-auto max-w-md px-4 pt-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"font-extrabold text-gray-900",children:["en"===e?"Search Results":"Natiijooyinka Raadinta",(0,a.jsxs)("span",{className:"ml-2 text-sm text-gray-500",children:["(",R.length,")"]})]}),(0,a.jsx)("button",{onClick:()=>s(""),className:"text-sm font-semibold text-[#0B6EA9]",children:"en"===e?"Clear":"Tirtir"})]}),(0,a.jsx)("div",{className:"mt-4 space-y-3",children:0===R.length?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"bg-white border rounded-2xl p-4 text-sm text-gray-600",children:["en"===e?(0,a.jsxs)(a.Fragment,{children:["No results for ",(0,a.jsx)("b",{children:r}),".",(0,a.jsx)("br",{}),(0,a.jsx)("span",{className:"block mt-2 text-gray-700",children:"Can't find what you need? We can try to source it for you."}),(0,a.jsx)("span",{className:"block mt-1 text-gray-700",children:"Do you want it yourself or know a shop that has it? Tap WhatsApp and send us details."})]}):(0,a.jsxs)(a.Fragment,{children:["Natiijo ma leh ",(0,a.jsx)("b",{children:r}),".",(0,a.jsx)("br",{}),(0,a.jsx)("span",{className:"block mt-2 text-gray-700",children:"Ma helaysid waxaad raadineysay? Waxaan isku dayi karnaa inaan kuu soo helno."}),(0,a.jsx)("span",{className:"block mt-1 text-gray-700",children:"Adigu ma rabtaa mise qof ama dukaan ayaad taqaannaa oo haysta? Riix WhatsApp oo noogu soo dir faahfaahinta."})]}),(0,a.jsx)("a",{href:`https://wa.me/252622073874?text=${encodeURIComponent(`MatoMart - I can't find this item: "${r}". Please help me source it.`)}`,target:"_blank",rel:"noopener noreferrer",className:"mt-3 inline-flex items-center justify-center rounded-full bg-[#0B6EA9] px-4 py-2 text-sm font-semibold text-white",children:"WhatsApp"})]}),O.length>0&&(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsx)("div",{className:"font-extrabold text-gray-900",children:"en"===e?"You may like these instead":"Kuwani ayaa laga yaabaa inay ku anficiyaan"}),(0,a.jsx)("div",{className:"mt-4 space-y-3",children:O.slice(0,8).map(e=>{let t=E(e.id),{price:r,mrp:s}=A(e.id,e.base_price),l=s&&r?Math.round((s-r)/s*100):null;return(0,a.jsxs)("div",{className:"bg-white border rounded-2xl p-3 flex gap-3",children:[(0,a.jsx)(n(),{href:`/product/${e.slug}`,className:"w-24 h-24 rounded-xl bg-gray-50 border overflow-hidden grid place-items-center",children:(0,a.jsx)(i.default,{src:t,alt:e.name,width:96,height:96,className:"object-contain"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)(n(),{href:`/product/${e.slug}`,className:"block",children:(0,a.jsx)("div",{className:"text-sm font-semibold text-gray-900 line-clamp-2",children:e.name})}),(0,a.jsxs)("div",{className:"mt-2 flex items-end gap-2",children:[(0,a.jsx)("div",{className:"text-lg font-extrabold text-gray-900",children:h(r)}),s?(0,a.jsx)("div",{className:"text-sm text-gray-400 line-through",children:h(s)}):null,l?(0,a.jsxs)("div",{className:"text-xs font-extrabold text-green-700 bg-green-50 px-2 py-1 rounded-full",children:[l,"% OFF"]}):null]}),(0,a.jsx)("div",{className:"mt-3 max-w-[160px]",children:(0,a.jsx)(c.default,{productId:e.id})})]})]},e.id)})})]})]}):R.map(e=>{let t=E(e.id),{price:r,mrp:s}=A(e.id,e.base_price),l=s&&r?Math.round((s-r)/s*100):null;return(0,a.jsxs)("div",{className:"bg-white border rounded-2xl p-3 flex gap-3",children:[(0,a.jsx)(n(),{href:`/product/${e.slug}`,className:"w-24 h-24 rounded-xl bg-gray-50 border overflow-hidden grid place-items-center",children:(0,a.jsx)(i.default,{src:t,alt:e.name,width:96,height:96,className:"object-contain"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)(n(),{href:`/product/${e.slug}`,className:"block",children:(0,a.jsx)("div",{className:"text-sm font-semibold text-gray-900 line-clamp-2",children:e.name})}),(0,a.jsxs)("div",{className:"mt-2 flex items-end gap-2",children:[(0,a.jsx)("div",{className:"text-lg font-extrabold text-gray-900",children:h(r)}),s?(0,a.jsx)("div",{className:"text-sm text-gray-400 line-through",children:h(s)}):null,l?(0,a.jsxs)("div",{className:"text-xs font-extrabold text-green-700 bg-green-50 px-2 py-1 rounded-full",children:[l,"% OFF"]}):null]}),(0,a.jsx)("div",{className:"mt-3 max-w-[160px]",children:(0,a.jsx)(c.default,{productId:e.id})})]})]},e.id)})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("section",{className:"mx-auto max-w-md px-4 pt-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"font-extrabold text-gray-900",children:"en"===e?"Recent Searches":"Raadintii u dambeysay"}),g.length>0?(0,a.jsx)("button",{onClick:()=>{localStorage.removeItem(u),p([])},className:"text-sm font-semibold text-[#0B6EA9]",children:"en"===e?"Clear":"Tirtir"}):null]}),(0,a.jsx)("div",{className:"mt-3 flex flex-wrap gap-2",children:0===g.length?(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"en"===e?"No recent searches yet.":"Weli wax raadis ah ma jiraan."}):g.map(e=>(0,a.jsx)("button",{onClick:()=>s(e),className:"px-3 py-1.5 rounded-full bg-gray-100 text-sm",children:e},e))})]}),(0,a.jsxs)("section",{className:"mx-auto max-w-md px-4 pt-8",children:[(0,a.jsx)("div",{className:"font-extrabold text-gray-900",children:"en"===e?"Popular Categories":"Qaybaha Caanka ah"}),(0,a.jsx)("div",{className:"mt-3 grid grid-cols-4 gap-3",children:B.map(t=>(0,a.jsxs)(n(),{href:`/category/${t.slug}`,className:"flex flex-col items-center text-center",children:[(0,a.jsx)("div",{className:"h-14 w-14 rounded-full bg-blue-50 overflow-hidden grid place-items-center",children:(0,a.jsx)(i.default,{src:(0,o.lN)(t.img),alt:f(t,e),width:56,height:56,className:"object-contain p-1"})}),(0,a.jsx)("div",{className:"mt-2 text-[11px] leading-tight",children:f(t,e)})]},t.id))})]}),(0,a.jsxs)("section",{className:"mx-auto max-w-md px-4 pt-8",children:[(0,a.jsx)("div",{className:"font-extrabold text-gray-900",children:"en"===e?"Quick Picks":"Doorasho Degdeg ah"}),(0,a.jsx)("div",{className:"mt-3 flex flex-wrap gap-2",children:$.map(t=>(0,a.jsx)(n(),{href:`/subcategory/${t.slug}`,className:"px-3 py-1.5 rounded-full border bg-white text-sm",children:f(t,e)},t.id))})]}),(0,a.jsxs)("section",{className:"mx-auto max-w-md px-4 pt-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"font-extrabold text-gray-900",children:"en"===e?"Recommended for you":"Kugula Talo Galay"}),(0,a.jsx)(n(),{href:"/",className:"text-sm font-semibold text-[#0B6EA9]",children:"en"===e?"Browse":"Daawo"})]}),(0,a.jsx)("div",{className:"mt-4 space-y-3",children:O.map(e=>{let t=E(e.id),{price:r,mrp:s}=A(e.id,e.base_price),l=s&&r?Math.round((s-r)/s*100):null;return(0,a.jsxs)("div",{className:"bg-white border rounded-2xl p-3 flex gap-3",children:[(0,a.jsx)(n(),{href:`/product/${e.slug}`,className:"w-24 h-24 rounded-xl bg-gray-50 border overflow-hidden grid place-items-center",children:(0,a.jsx)(i.default,{src:t,alt:e.name,width:96,height:96,className:"object-contain"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)(n(),{href:`/product/${e.slug}`,className:"block",children:(0,a.jsx)("div",{className:"text-sm font-semibold text-gray-900 line-clamp-2",children:e.name})}),(0,a.jsxs)("div",{className:"mt-2 flex items-end gap-2",children:[(0,a.jsx)("div",{className:"text-lg font-extrabold text-gray-900",children:h(r)}),s?(0,a.jsx)("div",{className:"text-sm text-gray-400 line-through",children:h(s)}):null,l?(0,a.jsxs)("div",{className:"text-xs font-extrabold text-green-700 bg-green-50 px-2 py-1 rounded-full",children:[l,"% OFF"]}):null]}),(0,a.jsx)("div",{className:"mt-3 max-w-[160px]",children:(0,a.jsx)(c.default,{productId:e.id})})]})]},e.id)})})]})]})]})}},7187:(e,t,r)=>{"use strict";r.d(t,{default:()=>l});var a=r(5155),s=r(2115),n=r(8561),i=r(6842);function l({productId:e}){let{items:t,addItem:r,setQty:l}=(0,n._)(),c=(0,s.useMemo)(()=>{let t=i.ko.filter(t=>t.product_id===e);return t.length?t.reduce((e,t)=>t.price<e.price?t:e,t[0]).id:null},[e]),d=t.find(t=>t.productId===e&&t.variantId===c),o=d?.qty??0;return d?(0,a.jsxs)("div",{className:"mt-2 flex items-center justify-between",children:[(0,a.jsx)("button",{onClick:()=>l(e,c,o-1),className:"w-10 h-10 rounded-full bg-[#0B6EA9] text-white text-xl",children:"−"}),(0,a.jsx)("span",{className:"font-bold",children:o}),(0,a.jsx)("button",{onClick:()=>l(e,c,o+1),className:"w-10 h-10 rounded-full bg-[#0B6EA9] text-white text-xl",children:"+"})]}):(0,a.jsx)("button",{onClick:()=>r(e,c,1),className:"mt-2 w-full h-10 rounded-xl border-2 border-[#0B6EA9] text-[#0B6EA9] font-bold",children:"Add +"})}},7270:(e,t,r)=>{"use strict";r.d(t,{Cd:()=>f,HZ:()=>j,J:()=>m,TW:()=>p,Tl:()=>x,VR:()=>n,Xo:()=>d,cg:()=>N,dC:()=>u,eN:()=>c,fS:()=>b,hB:()=>o,iV:()=>i,ii:()=>l,lN:()=>s,lv:()=>y,ob:()=>h,wR:()=>g});var a=r(117);function s(e){let t=String(e??"").trim();return t&&(t.startsWith("/")||t.startsWith("http://")||t.startsWith("https://"))?t:"/example.png"}async function n(){let{data:e,error:t}=await a.N.from("categories").select("id,slug,img,name_so,name_en").order("id",{ascending:!0});if(t)throw t;let{data:r,error:s}=await a.N.from("subcategories").select("id,category_id,slug,img,name_so,name_en").order("id",{ascending:!0});if(s)throw s;let n=r??[];return(e??[]).map(e=>({...e,subcats:n.filter(t=>t.category_id===e.id)}))}async function i(){let{data:e,error:t}=await a.N.from("categories").select("*").order("id");if(t)throw t;return e??[]}async function l(){let{data:e,error:t}=await a.N.from("subcategories").select("*").order("id");if(t)throw t;return e??[]}async function c(){let{data:e,error:t}=await a.N.from("products").select("*").order("id");if(t)throw t;return e??[]}async function d(){let{data:e,error:t}=await a.N.from("product_variants").select("*").order("id");if(t)throw t;return e??[]}async function o(){let{data:e,error:t}=await a.N.from("product_images").select("*").order("is_primary",{ascending:!1});if(t)throw t;return e??[]}async function u(e){let{data:t,error:r}=await a.N.from("subcategories").select("*").eq("slug",e).maybeSingle();if(r)throw console.error("fetchSubcategoryBySlug error:",{slug:e,error:r}),r;return t}async function m(e){let{data:t,error:r}=await a.N.from("products").select("*").eq("subcategory_id",e).order("id",{ascending:!0});if(r)throw r;return t??[]}async function x(e){let{data:t,error:r}=await a.N.from("subsubcategories").select("*").eq("subcategory_id",e).order("id",{ascending:!0});return r?[]:t??[]}async function h(e){let t=Array.from(new Set(e)).filter(Boolean);if(0===t.length)return[];let{data:r,error:s}=await a.N.from("products").select("id,name,slug,long_description,category_id,subcategory_id,brand_id,is_discounted,base_price,tags,is_active").in("id",t);if(s)throw s;return r??[]}async function f(e){let t=Array.from(new Set(e)).filter(e=>null!=e);if(0===t.length)return[];let{data:r,error:s}=await a.N.from("product_variants").select("id,product_id,label,price,stock").in("id",t);if(s)throw s;return r??[]}async function g(e){return h(e)}async function p(e){let t=Array.from(new Set(e)).filter(Boolean);if(0===t.length)return[];let{data:r,error:s}=await a.N.from("product_variants").select("*").in("product_id",t).order("price",{ascending:!0});if(s)throw s;return r??[]}async function y(e){let t=Array.from(new Set(e)).filter(Boolean);if(0===t.length)return[];let{data:r,error:s}=await a.N.from("product_images").select("*").in("product_id",t).order("is_primary",{ascending:!1});if(s)throw s;return r??[]}async function N(e){let t=e.trim();if(!t)return[];let{data:r,error:s}=await a.N.from("customers").select("id,name,phone").or(`name.ilike.%${t}%,phone.ilike.%${t}%`).limit(8);if(s)throw s;return r??[]}async function b(e){let{data:t,error:r}=await a.N.from("orders").insert({customer_id:e.customer_id,delivery_name:e.delivery.name,delivery_phone:e.delivery.phone,delivery_address:e.delivery.address,delivery_note:e.delivery.note??null,total_amount:e.total_amount,status:"PENDING"}).select("id").single();if(r)throw r;return t}async function j(e,t){let r=t.map(t=>({order_id:e,product_id:t.productId,variant_id:t.variantId,quantity:t.qty,price_at_purchase:t.priceAtPurchase})),{error:s}=await a.N.from("order_items").insert(r);if(s)throw console.log("ORDER_ITEMS_INSERT_ERROR",s),s}},8029:(e,t,r)=>{"use strict";r.d(t,{LanguageProvider:()=>c,o:()=>d});var a=r(5155),s=r(2115);let n=(0,s.createContext)(null),i="lang_v1",l="lang";function c({children:e}){let[t,r]=(0,s.useState)("so");return(0,s.useEffect)(()=>{let e=function(e){if("undefined"==typeof document)return"";let t=document.cookie.match(RegExp("(^| )"+e+"=([^;]+)"));return t?decodeURIComponent(t[2]):""}(l)||null,t=localStorage.getItem(i)||null;r(e||t||"so")},[]),(0,a.jsx)(n.Provider,{value:{lang:t,setLang:e=>{r(e),localStorage.setItem(i,e),function(e,t,r=365){let a=new Date;a.setTime(a.getTime()+24*r*36e5),document.cookie=`${e}=${encodeURIComponent(t)}; expires=${a.toUTCString()}; path=/`}(l,e)}},children:e})}function d(){let e=(0,s.useContext)(n);if(!e)throw Error("useLanguage must be used within LanguageProvider");return e}},8561:(e,t,r)=>{"use strict";r.d(t,{CartProvider:()=>i,_:()=>l});var a=r(5155),s=r(2115);let n=(0,s.createContext)(null);function i({children:e}){let[t,r]=(0,s.useState)([]);function i(e,t){r(r=>r.filter(r=>r.productId!==e||r.variantId!==t))}return(0,s.useEffect)(()=>{let e=localStorage.getItem("cart");e&&r(JSON.parse(e))},[]),(0,s.useEffect)(()=>{localStorage.setItem("cart",JSON.stringify(t))},[t]),(0,a.jsx)(n.Provider,{value:{items:t,addItem:function(e,t,a=1){r(r=>r.find(r=>r.productId===e&&r.variantId===t)?r.map(r=>r.productId===e&&r.variantId===t?{...r,qty:r.qty+a}:r):[...r,{productId:e,variantId:t,qty:a}])},setQty:function(e,t,a){a<=0?i(e,t):r(r=>r.map(r=>r.productId===e&&r.variantId===t?{...r,qty:a}:r))},removeItem:i,clearCart:function(){r([])}},children:e})}function l(){let e=(0,s.useContext)(n);if(!e)throw Error("useCart must be used inside CartProvider");return e}},9926:(e,t,r)=>{Promise.resolve().then(r.bind(r,368))}},e=>{e.O(0,[8500,1958,5772,6842,8441,3794,7358],()=>e(e.s=9926)),_N_E=e.O()}]);