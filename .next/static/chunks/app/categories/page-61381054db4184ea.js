(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2379],{117:(e,t,r)=>{"use strict";r.d(t,{N:()=>a});let a=(0,r(1958).UU)("https://ecfxrmhrfjqdmqewzrfz.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVjZnhybWhyZmpxZG1xZXd6cmZ6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYzNDA0OTgsImV4cCI6MjA4MTkxNjQ5OH0.jtF3Qp9N7rH-KCWEMHU0atH7h-LQEJBKYO9Q2HdxkX0")},688:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u});var a=r(5155),i=r(5772),s=r(8500),n=r.n(s),o=r(2115),l=r(1362),c=r(8029),d=r(7270);function u(){let{lang:e}=(0,c.o)(),[t,r]=(0,o.useState)([]),[s,u]=(0,o.useState)({}),[m,f]=(0,o.useState)(!0);return((0,o.useEffect)(()=>{!async function(){try{f(!0);let e=await (0,d.VR)();r(e);let t={};for(let r of e)for(let e of r.subcats){let r=await (0,d.Tl)(e.id);t[e.id]=r}u(t)}catch(e){console.error("getCategoriesWithSubcategories error",e),r([])}finally{f(!1)}}()},[]),m)?(0,a.jsx)("main",{className:"min-h-screen bg-[#F4F6F8] pb-20",children:(0,a.jsx)("section",{className:"mx-auto max-w-md bg-white border-b",children:(0,a.jsxs)("div",{className:"px-4 pt-4 pb-3",children:[(0,a.jsx)("h1",{className:"text-base font-semibold text-gray-900",children:"en"===e?"All Categories":"Dhammaan Qaybaha"}),(0,a.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"en"===e?"Loading categories...":"Qaybaha ayaa soo dhacaya..."})]})})}):(0,a.jsxs)("main",{className:"min-h-screen bg-[#F4F6F8] pb-20",children:[(0,a.jsx)("section",{className:"mx-auto max-w-md bg-white border-b",children:(0,a.jsxs)("div",{className:"px-4 pt-4 pb-3",children:[(0,a.jsx)("h1",{className:"text-base font-semibold text-gray-900",children:"en"===e?"All Categories":"Dhammaan Qaybaha"}),(0,a.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"en"===e?"Browse all sections of the store.":"Ka dooro qaybaha kala duwan ee dukaanka."})]})}),(0,a.jsx)("section",{className:"mx-auto max-w-md mt-2 space-y-4",children:t.flatMap(t=>t.subcats.map(t=>(0,a.jsxs)("div",{className:"bg-white border-b rounded-lg pb-3",children:[(0,a.jsx)("div",{className:"flex items-center justify-between px-4 pt-4",children:(0,a.jsx)("h2",{className:"text-base font-semibold text-gray-900",children:t.name_en||t.name_so})}),(0,a.jsx)("div",{className:"mt-3 px-4",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("div",{className:"flex gap-3 overflow-x-auto pb-1 pr-6",children:[(s[t.id]??[]).map(e=>(0,a.jsxs)(n(),{href:`/subcategory/${t.slug}?ss=${e.slug}`,className:"min-w-[110px] max-w-[115px] rounded-xl bg-[#EAF3FF] px-2 py-2 flex flex-col items-center",children:[(0,a.jsx)("div",{className:"h-10 w-full mb-2 flex items-center justify-center",children:(0,a.jsx)(i.default,{src:("string"==typeof e.img?e.img.trim():"/example.png")||"/example.png",alt:e.name_so||e.name_en,width:70,height:55,className:"object-contain"})}),(0,a.jsx)("div",{className:"text-[11px] font-semibold text-gray-900 leading-tight text-center line-clamp-2",children:e.name_en||e.name_so})]},e.id)),(!s[t.id]||0===s[t.id].length)&&(0,a.jsx)("div",{className:"text-[10px] text-gray-500 italic px-2 py-1",children:"en"===e?"No subcategories":"Qeybo ma jiro"})]}),(s[t.id]?.length??0)>4&&(0,a.jsx)("div",{className:"pointer-events-none absolute inset-y-0 right-0 w-8 bg-gradient-to-l from-[#F4F6F8] to-transparent flex items-center justify-center",children:(0,a.jsx)(l.A,{className:"h-4 w-4 text-gray-400"})})]})})]},t.id)))})]})}},1362:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(8340).A)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},6198:(e,t,r)=>{Promise.resolve().then(r.bind(r,688))},7270:(e,t,r)=>{"use strict";r.d(t,{Cd:()=>g,HZ:()=>N,J:()=>m,TW:()=>x,Tl:()=>f,VR:()=>s,Xo:()=>c,cg:()=>w,dC:()=>u,eN:()=>l,fS:()=>b,hB:()=>d,iV:()=>n,ii:()=>o,lN:()=>i,lv:()=>y,ob:()=>h,wR:()=>p});var a=r(117);function i(e){let t=String(e??"").trim();return t&&(t.startsWith("/")||t.startsWith("http://")||t.startsWith("https://"))?t:"/example.png"}async function s(){let{data:e,error:t}=await a.N.from("categories").select("id,slug,img,name_so,name_en").order("id",{ascending:!0});if(t)throw t;let{data:r,error:i}=await a.N.from("subcategories").select("id,category_id,slug,img,name_so,name_en").order("id",{ascending:!0});if(i)throw i;let s=r??[];return(e??[]).map(e=>({...e,subcats:s.filter(t=>t.category_id===e.id)}))}async function n(){let{data:e,error:t}=await a.N.from("categories").select("*").order("id");if(t)throw t;return e??[]}async function o(){let{data:e,error:t}=await a.N.from("subcategories").select("*").order("id");if(t)throw t;return e??[]}async function l(){let{data:e,error:t}=await a.N.from("products").select("*").order("id");if(t)throw t;return e??[]}async function c(){let{data:e,error:t}=await a.N.from("product_variants").select("*").order("id");if(t)throw t;return e??[]}async function d(){let{data:e,error:t}=await a.N.from("product_images").select("*").order("is_primary",{ascending:!1});if(t)throw t;return e??[]}async function u(e){let{data:t,error:r}=await a.N.from("subcategories").select("*").eq("slug",e).maybeSingle();if(r)throw console.error("fetchSubcategoryBySlug error:",{slug:e,error:r}),r;return t}async function m(e){let{data:t,error:r}=await a.N.from("products").select("*").eq("subcategory_id",e).order("id",{ascending:!0});if(r)throw r;return t??[]}async function f(e){let{data:t,error:r}=await a.N.from("subsubcategories").select("*").eq("subcategory_id",e).order("id",{ascending:!0});return r?[]:t??[]}async function h(e){let t=Array.from(new Set(e)).filter(Boolean);if(0===t.length)return[];let{data:r,error:i}=await a.N.from("products").select("id,name,slug,long_description,category_id,subcategory_id,brand_id,is_discounted,base_price,tags,is_active").in("id",t);if(i)throw i;return r??[]}async function g(e){let t=Array.from(new Set(e)).filter(e=>null!=e);if(0===t.length)return[];let{data:r,error:i}=await a.N.from("product_variants").select("id,product_id,label,price,stock").in("id",t);if(i)throw i;return r??[]}async function p(e){return h(e)}async function x(e){let t=Array.from(new Set(e)).filter(Boolean);if(0===t.length)return[];let{data:r,error:i}=await a.N.from("product_variants").select("*").in("product_id",t).order("price",{ascending:!0});if(i)throw i;return r??[]}async function y(e){let t=Array.from(new Set(e)).filter(Boolean);if(0===t.length)return[];let{data:r,error:i}=await a.N.from("product_images").select("*").in("product_id",t).order("is_primary",{ascending:!1});if(i)throw i;return r??[]}async function w(e){let t=e.trim();if(!t)return[];let{data:r,error:i}=await a.N.from("customers").select("id,name,phone").or(`name.ilike.%${t}%,phone.ilike.%${t}%`).limit(8);if(i)throw i;return r??[]}async function b(e){let{data:t,error:r}=await a.N.from("orders").insert({customer_id:e.customer_id,delivery_name:e.delivery.name,delivery_phone:e.delivery.phone,delivery_address:e.delivery.address,delivery_note:e.delivery.note??null,total_amount:e.total_amount,status:"PENDING"}).select("id").single();if(r)throw r;return t}async function N(e,t){let r=t.map(t=>({order_id:e,product_id:t.productId,variant_id:t.variantId,quantity:t.qty,price_at_purchase:t.priceAtPurchase})),{error:i}=await a.N.from("order_items").insert(r);if(i)throw console.log("ORDER_ITEMS_INSERT_ERROR",i),i}},8029:(e,t,r)=>{"use strict";r.d(t,{LanguageProvider:()=>l,o:()=>c});var a=r(5155),i=r(2115);let s=(0,i.createContext)(null),n="lang_v1",o="lang";function l({children:e}){let[t,r]=(0,i.useState)("so");return(0,i.useEffect)(()=>{let e=function(e){if("undefined"==typeof document)return"";let t=document.cookie.match(RegExp("(^| )"+e+"=([^;]+)"));return t?decodeURIComponent(t[2]):""}(o)||null,t=localStorage.getItem(n)||null;r(e||t||"so")},[]),(0,a.jsx)(s.Provider,{value:{lang:t,setLang:e=>{r(e),localStorage.setItem(n,e),function(e,t,r=365){let a=new Date;a.setTime(a.getTime()+24*r*36e5),document.cookie=`${e}=${encodeURIComponent(t)}; expires=${a.toUTCString()}; path=/`}(o,e)}},children:e})}function c(){let e=(0,i.useContext)(s);if(!e)throw Error("useLanguage must be used within LanguageProvider");return e}},8340:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var a=r(2115);let i=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},s=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim();var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=(0,a.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:i,className:o="",children:l,iconNode:c,...d},u)=>(0,a.createElement)("svg",{ref:u,...n,width:t,height:t,stroke:e,strokeWidth:i?24*Number(r)/Number(t):r,className:s("lucide",o),...!l&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(d)&&{"aria-hidden":"true"},...d},[...c.map(([e,t])=>(0,a.createElement)(e,t)),...Array.isArray(l)?l:[l]])),l=(e,t)=>{let r=(0,a.forwardRef)(({className:r,...n},l)=>(0,a.createElement)(o,{ref:l,iconNode:t,className:s(`lucide-${i(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,r),...n}));return r.displayName=i(e),r}}},e=>{e.O(0,[8500,1958,5772,8441,3794,7358],()=>e(e.s=6198)),_N_E=e.O()}]);