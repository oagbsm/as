{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/a./mato1/lib/supabaseClient.ts"],"sourcesContent":["import { createClient } from \"@supabase/supabase-js\";\n\nexport const supabase = createClient(\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\n  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\n);\n"],"names":[],"mappings":";;;;AAGE;AAHF;;AAEO,MAAM,WAAW,IAAA,iMAAY"}},
    {"offset": {"line": 19, "column": 0}, "map": {"version":3,"sources":["file:///Users/a./mato1/lib/db.ts"],"sourcesContent":["// lib/db.ts\nimport { supabase } from \"@/lib/supabaseClient\";\n\n/* =========================\n   Helpers\n========================= */\n\nexport function safeImg(src: any) {\n  const s = String(src ?? \"\").trim();\n  if (!s) return \"/example.png\";\n  if (s.startsWith(\"/\")) return s;\n  if (s.startsWith(\"http://\") || s.startsWith(\"https://\")) return s;\n  return \"/example.png\";\n}\n\n/* =========================\n   Types\n========================= */\n\ntype CategoryRow = {\n  id: number;\n  slug: string;\n  img: string | null;\n  name_so: string;\n  name_en: string;\n};\n\ntype SubcategoryRow = {\n  id: number;\n  category_id: number;\n  slug: string;\n  img: string | null;\n  name_so: string;\n  name_en: string;\n};\n\nexport type ProductRow = {\n  id: number;\n  name: string;\n  slug: string;\n  base_price: number; // numeric NOT NULL in DB\n  long_description: string; // NOT NULL in DB\n  category_id: number;\n  subcategory_id: number;\n  brand_id: number;\n  is_discounted: boolean;\n  tags?: string[] | null;\n  is_active: boolean;\n};\nexport type VariantRow = {\n  id: number;\n  product_id: number;\n  label: string;\n  price: number;\n\n  // optional if you track stock\n  stock?: number | null;\n};\n\n/* =========================\n   Home (categories + subcats)\n========================= */\n\nexport async function getCategoriesWithSubcategories() {\n  const { data: cats, error: catErr } = await supabase\n    .from(\"categories\")\n    .select(\"id,slug,img,name_so,name_en\")\n    .order(\"id\", { ascending: true });\n\n  if (catErr) throw catErr;\n\n  const { data: subs, error: subErr } = await supabase\n    .from(\"subcategories\")\n    .select(\"id,category_id,slug,img,name_so,name_en\")\n    .order(\"id\", { ascending: true });\n\n  if (subErr) throw subErr;\n\n  const categories = (cats ?? []) as CategoryRow[];\n  const subcategories = (subs ?? []) as SubcategoryRow[];\n\n  return categories.map((cat) => ({\n    ...cat,\n    subcats: subcategories.filter((s) => s.category_id === cat.id),\n  }));\n}\n\n/* =========================\n   Search page: fetch everything\n========================= */\n\nexport async function fetchAllCategories() {\n  const { data, error } = await supabase.from(\"categories\").select(\"*\").order(\"id\");\n  if (error) throw error;\n  return data ?? [];\n}\n\nexport async function fetchAllSubcategories() {\n  const { data, error } = await supabase.from(\"subcategories\").select(\"*\").order(\"id\");\n  if (error) throw error;\n  return data ?? [];\n}\n\nexport async function fetchAllProducts() {\n  const { data, error } = await supabase.from(\"products\").select(\"*\").order(\"id\");\n  if (error) throw error;\n  return data ?? [];\n}\n\nexport async function fetchAllProductVariants() {\n  const { data, error } = await supabase.from(\"product_variants\").select(\"*\").order(\"id\");\n  if (error) throw error;\n  return data ?? [];\n}\n\nexport async function fetchAllProductImages() {\n  const { data, error } = await supabase\n    .from(\"product_images\")\n    .select(\"*\")\n    .order(\"is_primary\", { ascending: false });\n  if (error) throw error;\n  return data ?? [];\n}\n\n/* =========================\n   Subcategory page helpers\n========================= */\n\nexport async function fetchSubcategoryBySlug(slug: string) {\n  const { data, error } = await supabase\n    .from(\"subcategories\")\n    .select(\"*\")\n    .eq(\"slug\", slug)\n    .maybeSingle();\n\n  if (error) {\n    console.error(\"fetchSubcategoryBySlug error:\", { slug, error });\n    throw error;\n  }\n\n  return data;\n}\nexport async function fetchBrandsByIds(ids: number[]) {\n  try {\n    const clean = Array.from(\n      new Set((ids || []).map((x) => Number(x)).filter((n) => Number.isFinite(n)))\n    );\n    if (!clean.length) return [];\n\n    const { data, error } = await supabase\n      .from(\"brands\")\n      .select(\"id,name,slug\")\n      .in(\"id\", clean)\n      .order(\"name\", { ascending: true });\n\n    if (error) {\n      console.error(\"fetchBrandsByIds error\", error);\n      return [];\n    }\n\n    return data ?? [];\n  } catch (e) {\n    console.error(\"fetchBrandsByIds exception\", e);\n    return [];\n  }\n}\n\nexport async function fetchProductBySlug(slug: string) {\n  const { data, error } = await supabase\n    .from(\"products\")\n    .select(\"*\")\n    .eq(\"slug\", slug)\n    .maybeSingle(); // ✅ doesn't throw when 0 rows\n\n  if (error) {\n    console.error(\"fetchProductBySlug error:\", { slug, error });\n    throw error; // ✅ stop masking real errors as 404\n  }\n\n  return data as ProductRow | null;\n}\n\nexport async function fetchProductsBySubcategoryId(subcategoryId: number) {\n  const { data, error } = await supabase\n    .from(\"products\")\n    .select(\"*\")\n    .eq(\"subcategory_id\", subcategoryId)\n    .order(\"id\", { ascending: true });\n\n  if (error) throw error;\n  return data ?? [];\n}\n\n/**\n * If you don't have subsubcategories yet, you can keep this returning []\n * OR create the table and remove the try/catch.\n */\nexport async function fetchSubSubcategoriesBySubcategoryId(subcategoryId: number) {\n  const { data, error } = await supabase\n    .from(\"subsubcategories\")\n    .select(\"*\")\n    .eq(\"subcategory_id\", subcategoryId)\n    .order(\"id\", { ascending: true });\n\n  // If the table doesn't exist yet, you can return [] instead of throwing.\n  if (error) {\n    // Uncomment next line if you prefer hard-fail:\n    // throw error;\n    return [];\n  }\n  return data ?? [];\n}\n\n/* =========================\n   Product page helpers\n========================= */\n\n\nexport async function fetchSubcategoryById(id: number) {\n  const { data, error } = await supabase.from(\"subcategories\").select(\"*\").eq(\"id\", id).single();\n  if (error) return null;\n  return data;\n}\n\n/**\n * IMPORTANT: object signature (fixes your 22P02 crash).\n */\nexport async function fetchRelatedProducts(args: {\n  subcategoryId: number;\n  excludeProductId: number;\n  limit?: number;\n}) {\n  const limit = args.limit ?? 12;\n\n  const { data, error } = await supabase\n    .from(\"products\")\n    .select(\"*\")\n    .eq(\"subcategory_id\", args.subcategoryId)\n    .neq(\"id\", args.excludeProductId)\n    .limit(limit);\n\n  if (error) throw error;\n  return data ?? [];\n}\n  \n/* =========================\n   Products / Variants / Images: by ids\n========================= */\n\nexport async function getProductsByIds(ids: number[]) {\n  const unique = Array.from(new Set(ids)).filter(Boolean);\n  if (unique.length === 0) return [];\n\n  const { data, error } = await supabase\n    .from(\"products\")\n.select(\n  \"id,name,slug,long_description,category_id,subcategory_id,brand_id,is_discounted,base_price,tags,is_active\"\n).in(\"id\", unique);\n\n  if (error) throw error;\n  return (data ?? []) as ProductRow[];\n}\n\nexport async function getVariantsByIds(ids: number[]) {\n  const unique = Array.from(new Set(ids)).filter((x) => x != null) as number[];\n  if (unique.length === 0) return [];\n\n  const { data, error } = await supabase\n    .from(\"product_variants\")\n    .select(\"id,product_id,label,price,stock\")\n    .in(\"id\", unique);\n\n  if (error) throw error;\n  return (data ?? []) as VariantRow[];\n}\n\nexport async function fetchProductsByIds(ids: number[]) {\n  // alias used by some pages\n  return getProductsByIds(ids);\n}\n\nexport async function fetchVariantsByProductIds(productIds: number[]) {\n  const unique = Array.from(new Set(productIds)).filter(Boolean);\n  if (unique.length === 0) return [];\n\n  const { data, error } = await supabase\n    .from(\"product_variants\")\n    .select(\"*\")\n    .in(\"product_id\", unique)\n    .order(\"price\", { ascending: true });\n\n  if (error) throw error;\n  return data ?? [];\n}\n\nexport async function fetchImagesByProductIds(productIds: number[]) {\n  const unique = Array.from(new Set(productIds)).filter(Boolean);\n  if (unique.length === 0) return [];\n\n  const { data, error } = await supabase\n    .from(\"product_images\")\n    .select(\"*\")\n    .in(\"product_id\", unique)\n    .order(\"is_primary\", { ascending: false });\n\n  if (error) throw error;\n  return data ?? [];\n}\n\n/* =========================\n   Single-ID wrappers (your product page imports these)\n========================= */\n\nexport async function fetchVariantsByProductId(productId: number) {\n  return fetchVariantsByProductIds([productId]);\n}\n\nexport async function fetchImagesByProductId(productId: number) {\n  return fetchImagesByProductIds([productId]);\n}\n\n/* =========================\n   Co-purchase (recommendations)\n========================= */\n\nexport async function fetchBoughtTogetherProductIds(args: {\n  productId: number;\n  limit?: number;\n  excludeIds?: number[];\n}) {\n  const limit = args.limit ?? 12;\n  const exclude = new Set([args.productId, ...(args.excludeIds ?? [])]);\n\n  const { data, error } = await supabase\n    .from(\"copurchase_counts\")\n    .select(\"co_product_id,count\")\n    .eq(\"product_id\", args.productId)\n    .order(\"count\", { ascending: false })\n    .limit(limit * 3);\n\n  if (error) throw error;\n\n  const ids: number[] = [];\n  for (const row of data ?? []) {\n    const id = Number((row as any).co_product_id);\n    if (!exclude.has(id)) ids.push(id);\n    if (ids.length >= limit) break;\n  }\n  return ids;\n}\n\n/* =========================\n   Customers (optional)\n========================= */\n\nexport async function searchCustomers(query: string) {\n  const q = query.trim();\n  if (!q) return [];\n\n  const { data, error } = await supabase\n    .from(\"customers\")\n    .select(\"id,name,phone\")\n    .or(`name.ilike.%${q}%,phone.ilike.%${q}%`)\n    .limit(8);\n\n  if (error) throw error;\n  return data ?? [];\n}\n\n/* =========================\n   Orders (checkout)\n========================= */\n\nexport async function createOrder(args: {\n  customer_id: number | null;\n  delivery: { name: string; phone: string; address: string; note?: string };\n  total_amount: number;\n}) {\n  const { data, error } = await supabase\n    .from(\"orders\")\n    .insert({\n      customer_id: args.customer_id,\n      delivery_name: args.delivery.name,\n      delivery_phone: args.delivery.phone,\n      delivery_address: args.delivery.address,\n      delivery_note: args.delivery.note ?? null,\n      total_amount: args.total_amount,\n      status: \"PENDING\",\n    })\n    .select(\"id\")\n    .single();\n\n  if (error) throw error;\n  return data as { id: number };\n}\n\nexport async function createOrderItems(\n  orderId: number,\n  items: Array<{\n    productId: number;\n    variantId: number | null;\n    qty: number;\n    priceAtPurchase: number;\n  }>\n) {\n  const payload = items.map((it) => ({\n    order_id: orderId,\n    product_id: it.productId,\n    variant_id: it.variantId,\n    quantity: it.qty,\n    price_at_purchase: it.priceAtPurchase,\n  }));\n\n  const { error } = await supabase.from(\"order_items\").insert(payload);\n\n  if (error) {\n    // helpful debugging\n    console.log(\"ORDER_ITEMS_INSERT_ERROR\", error);\n    throw error;\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 299, "column": 0}, "map": {"version":3,"sources":["file:///Users/a./mato1/app/subcategory/%5Bslug%5D/page.tsx"],"sourcesContent":["\"use client\";\n\nimport Image from \"next/image\";\nimport Link from \"next/link\";\nimport { useMemo, useState, useEffect } from \"react\";\nimport { useParams } from \"next/navigation\";\n\nimport { useCart } from \"@/context/CartContext\";\nimport { useLanguage } from \"@/context/LanguageContext\";\n\nimport {\n  fetchSubcategoryBySlug,\n  fetchSubSubcategoriesBySubcategoryId,\n  fetchProductsBySubcategoryId,\n  fetchVariantsByProductIds,\n  fetchImagesByProductIds,\n} from \"@/lib/db\";\n\n/** ===== helpers ===== */\nfunction money(n: number) {\n  return `$${Number(n ?? 0).toFixed(2)}`;\n}\n\nfunction safeImg(src: any) {\n  const s = String(src ?? \"\");\n  const clean = s.trim();\n  if (!clean) return \"/example.png\";\n  if (clean.startsWith(\"http://\") || clean.startsWith(\"https://\")) return clean;\n  if (clean.startsWith(\"/\")) return clean;\n  return \"/example.png\";\n}\n\nfunction getLabel(obj: any, lang: \"so\" | \"en\") {\n  const so = obj?.name_so ?? obj?.name ?? \"\";\n  const en = obj?.name_en ?? obj?.name ?? \"\";\n  return lang === \"en\" ? en : so;\n}\n\nfunction getSecondary(obj: any, lang: \"so\" | \"en\") {\n  const so = obj?.name_so ?? obj?.name ?? \"\";\n  const en = obj?.name_en ?? obj?.name ?? \"\";\n  return lang === \"en\" ? so : en;\n}\n\nfunction norm(x: any) {\n  return String(x ?? \"\")\n    .toLowerCase()\n    .trim()\n    .replace(/[-_]+/g, \" \")\n    .replace(/\\s+/g, \" \");\n}\n\n/** ===== page ===== */\nexport default function SubcategoryPage() {\n  const { slug } = useParams<{ slug: string }>();\n  const { items, addItem, setQty } = useCart();\n  const { lang } = useLanguage();\n\n  const [loading, setLoading] = useState(true);\n  const [currentSub, setCurrentSub] = useState<any | null>(null);\n  const [ssList, setSsList] = useState<any[]>([]);\n  const [products, setProducts] = useState<any[]>([]);\n  const [variants, setVariants] = useState<any[]>([]);\n  const [images, setImages] = useState<any[]>([]);\n\n  const [activeSS, setActiveSS] = useState<string | null>(null);\n  const [selectedVariantByProduct, setSelectedVariantByProduct] = useState<\n    Record<number, number | null>\n  >({});\n  const [justAddedId, setJustAddedId] = useState<number | null>(null);\n\n  useEffect(() => {\n    setLoading(true);\n    setActiveSS(null);\n    (async () => {\n      const sub = await fetchSubcategoryBySlug(String(slug));\n      if (!sub) {\n        setCurrentSub(null);\n        setSsList([]);\n        setProducts([]);\n        setVariants([]);\n        setImages([]);\n        setLoading(false);\n        return;\n      }\n\n      const prods = await fetchProductsBySubcategoryId(sub.id);\n      const ids = prods.map((p: any) => p.id);\n\n      const [sss, vars, imgs] = await Promise.all([\n        fetchSubSubcategoriesBySubcategoryId(sub.id),\n        fetchVariantsByProductIds(ids),\n        fetchImagesByProductIds(ids),\n      ]);\n\n      setCurrentSub(sub);\n      setSsList(sss);\n      setProducts(prods);\n      setVariants(vars);\n      setImages(imgs);\n\n      setLoading(false);\n    })();\n  }, [slug]);\n\n  useEffect(() => {\n    if (justAddedId === null) return;\n    const t = setTimeout(() => setJustAddedId(null), 900);\n    return () => clearTimeout(t);\n  }, [justAddedId]);\n\n  const getPrimaryImageUrl = (productId: number) => {\n    const primary = images.find(\n      (img: any) => img.product_id === productId && img.is_primary\n    );\n    const anyImg = images.find((img: any) => img.product_id === productId);\n    return safeImg(primary?.url || anyImg?.url || \"/example.png\");\n  };\n\n  const getVariantsFor = (productId: number) => {\n    return variants\n      .filter((v: any) => v.product_id === productId)\n      .slice()\n      .sort((a: any, b: any) => a.price - b.price);\n  };\n\n  const getDefaultVariantId = (productId: number) => {\n    const vars = getVariantsFor(productId);\n    return vars.length ? vars[0].id : null;\n  };\n\n  const getVariantById = (productId: number, variantId: number | null) => {\n    if (variantId == null) return null;\n    return (\n      variants.find(\n        (v: any) => v.product_id === productId && v.id === variantId\n      ) || null\n    );\n  };\n\n  const getVariantPrice = (\n    productId: number,\n    variantId: number | null,\n    basePrice?: number\n  ) => {\n    if (variantId == null) return Number(basePrice ?? 0);\n    const v = getVariantById(productId, variantId);\n    return Number(v?.price ?? basePrice ?? 0);\n  };\n\n  const getVariantMRP = (productId: number, variantId: number | null) => {\n    if (variantId == null) return null;\n    const v = getVariantById(productId, variantId);\n    return v?.mrp ?? null;\n  };\n\n  const baseList = useMemo(\n    () => products.filter((p: any) => p.subcategory_id === currentSub?.id),\n    [products, currentSub?.id]\n  );\n\n  const filtered = useMemo(() => {\n    let list = baseList;\n\n    if (activeSS) {\n      const ss = ssList.find((x: any) => x.slug === activeSS);\n      const slugKey = norm(activeSS);\n      const nameKey = norm(\n        ss?.name ?? ss?.name_en ?? ss?.name_so ?? \"\"\n      );\n\n      list = list.filter((p: any) => {\n        const tags = Array.isArray(p.tags) ? p.tags : [];\n        const tagStr = tags.map(norm);\n        return (\n          tagStr.includes(slugKey) ||\n          (nameKey && tagStr.includes(nameKey))\n        );\n      });\n    }\n\n    return list;\n  }, [activeSS, baseList, ssList]);\n\n  useEffect(() => {\n    setSelectedVariantByProduct((prev) => {\n      const next = { ...prev };\n      for (const p of filtered as any[]) {\n        if (next[p.id] === undefined) {\n          next[p.id] = getDefaultVariantId(p.id);\n        }\n      }\n      return next;\n    });\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [filtered.length, variants.length]);\n\nconst activeObj = activeSS\n  ? ssList.find((x: any) => x.slug === activeSS)\n  : null;\n\nconst titlePrimary = activeObj\n  ? getLabel(activeObj, lang)\n  : getLabel(currentSub, lang);\nconst titleSecondary = activeObj\n  ? getSecondary(activeObj, lang)\n  : getSecondary(currentSub, lang);\n\nconst seoLine =\n  lang === \"so\"\n    ? `Ka hel ${titlePrimary} (${titleSecondary}) online MatoMart – raashin iyo alaabooyin tayo leh oo lagu keeno gudaha Soomaaliya.`\n    : `Shop ${titleSecondary} (${titlePrimary}) online in Somalia with MatoMart – quality groceries and essentials delivered fast.`;\n\n  // (brand filter UI removed)\n\n  const cartTotals = useMemo(() => {\n    let total = 0;\n    let count = 0;\n\n    for (const it of items ?? []) {\n      const p: any = products.find((x: any) => x.id === it.productId);\n      if (!p) continue;\n\n      const price = getVariantPrice(\n        it.productId,\n        it.variantId ?? null,\n        p.base_price\n      );\n      total += price * (it.qty ?? 1);\n      count += it.qty ?? 1;\n    }\n\n    return { total, count };\n  }, [items, products]);\n\n  /** ===== Subcategory JSON-LD (CollectionPage + ItemList) ===== */\n  const jsonLdString = useMemo(() => {\n    try {\n      const origin =\n        typeof window !== \"undefined\" ? window.location.origin : \"\";\n      const url = origin\n        ? `${origin}/subcategory/${String(slug)}`\n        : undefined;\n\n      const items = (baseList as any[]).map((p, index) => {\n        const prodUrl = origin\n          ? `${origin}/product/${p.slug}`\n          : `/product/${p.slug}`;\n\n        const entry: any = {\n          \"@type\": \"Product\",\n          position: index + 1,\n          name: p.name,\n          url: prodUrl,\n        };\n\n        return entry;\n      });\n\n      const ld: any = {\n        \"@context\": \"https://schema.org\",\n        \"@type\": \"CollectionPage\",\n        name: titlePrimary,\n        description: seoLine,\n        mainEntity: {\n          \"@type\": \"ItemList\",\n          numberOfItems: items.length,\n          itemListElement: items,\n        },\n      };\n\n      if (url) ld.url = url;\n\n      return JSON.stringify(ld);\n    } catch {\n      return \"\";\n    }\n  }, [slug, baseList, titlePrimary, seoLine]);\n\n  if (!loading && !currentSub) {\n    return (\n      <main className=\"min-h-screen bg-white p-6 text-black\">\n        Subcategory not found.\n      </main>\n    );\n  }\n\n  function ProductAdd({\n    productId,\n    basePrice,\n    selectedVariantId,\n  }: {\n    productId: number;\n    basePrice?: number;\n    selectedVariantId: number | null;\n  }) {\n    const item = (items ?? []).find(\n      (i: any) =>\n        i.productId === productId &&\n        (i.variantId ?? null) === (selectedVariantId ?? null)\n    );\n    const qty = item?.qty ?? 0;\n\n    if (!item) {\n      return (\n        <button\n          onClick={() => {\n            addItem(productId, selectedVariantId, 1);\n            setJustAddedId(productId);\n          }}\n          className=\"mt-2 w-full h-10 rounded-xl border-2 border-[#0B6EA9] text-[#0B6EA9] font-bold flex items-center justify-center gap-2 active:scale-[0.99] transition\"\n        >\n          {lang === \"en\" ? \"Add\" : \"Ku dar\"}{\" \"}\n          <span className=\"text-xl leading-none\">+</span>\n        </button>\n      );\n    }\n\n    return (\n      <div className=\"mt-2 flex items-center justify-between\">\n        <button\n          onClick={() => setQty(productId, selectedVariantId, qty - 1)}\n          className=\"w-10 h-10 rounded-full bg-[#0B6EA9] text-white text-xl font-bold grid place-items-center\"\n        >\n          −\n        </button>\n\n        <div className=\"text-sm font-extrabold text-gray-900\">{qty}</div>\n\n        <button\n          onClick={() => setQty(productId, selectedVariantId, qty + 1)}\n          className=\"w-10 h-10 rounded-full bg-[#0B6EA9] text-white text-xl font-bold grid place-items-center\"\n        >\n          +\n        </button>\n      </div>\n    );\n  }\n\n  const hasRail = ssList.length > 0;\n\n  return (\n    <>\n      {jsonLdString && (\n        <script\n          type=\"application/ld+json\"\n          suppressHydrationWarning\n          dangerouslySetInnerHTML={{ __html: jsonLdString }}\n        />\n      )}\n\n      <main className=\"min-h-screen bg-[#F4F6F8] pb-28\">\n        {/* TITLE + SORT/FILTER */}\n        <section className=\"bg-white border-b\">\n          <div className=\"mx-auto max-w-md px-4 py-2 flex items-center justify-between\">\n            <div className=\"leading-tight\">\n              <div className=\"text-[13px] font-semibold text-gray-900\">\n                {loading ? \"...\" : titlePrimary}\n              </div>\n              <div className=\"text-[10px] text-gray-500\">\n                {loading ? \"\" : titleSecondary}\n              </div>\n              {!loading && (\n                <p className=\"mt-0.5 text-[10px] text-gray-500 max-w-xs leading-snug\">\n                  {seoLine}\n                </p>\n              )}\n            </div>\n            <div className=\"w-8\" />\n          </div>\n\n          <div className=\"mx-auto max-w-md px-4 pb-2 space-y-1.5\"></div>\n        </section>\n\n        {/* MAIN */}\n        <section\n          className={`mx-auto max-w-md grid ${\n            hasRail ? \"grid-cols-[72px_1fr]\" : \"grid-cols-1\"\n          }`}\n        >\n          {/* LEFT RAIL */}\n          {hasRail && (\n            <aside className=\"bg-gray-50 border-r px-1.5 py-2 space-y-1.5\">\n              <button\n                type=\"button\"\n                onClick={() => setActiveSS(null)}\n                className={`w-full flex items-center justify-center rounded-xl px-2 py-3 ${\n                  activeSS === null\n                    ? \"bg-[#0B6EA9]/10 border border-[#0B6EA9]\"\n                    : \"bg-white border border-gray-200\"\n                }`}\n              >\n                <span\n                  className={`text-[11px] font-bold ${\n                    activeSS === null ? \"text-[#0B6EA9]\" : \"text-gray-800\"\n                  }`}\n                >\n                  {lang === \"en\" ? \"ALL\" : \"DHAMMAAN\"}\n                </span>\n              </button>\n\n              {ssList.map((ss: any) => {\n                const isActive = activeSS === ss.slug;\n                const primary = getLabel(ss, lang);\n\n                return (\n                  <button\n                    key={ss.id}\n                    type=\"button\"\n                    onClick={() => setActiveSS(ss.slug)}\n                    className=\"w-full flex flex-col items-center rounded-xl px-1.5 py-2\"\n                  >\n                    <div className=\"w-14 h-14 rounded-xl bg-gray-100 overflow-hidden relative\">\n                      <Image\n                        src={safeImg(ss.img)}\n                        alt={primary}\n                        fill\n                        className=\"object-contain p-2\"\n                      />\n                    </div>\n                    <div className=\"mt-1 text-[10px] text-center leading-tight\">\n                      <div\n                        className={\n                          isActive\n                            ? \"text-[#0B6EA9] font-semibold\"\n                            : \"text-gray-800 font-semibold\"\n                        }\n                      >\n                        {primary}\n                      </div>\n                    </div>\n                  </button>\n                );\n              })}\n            </aside>\n          )}\n\n          {/* RIGHT GRID */}\n          <div className=\"p-3\">\n            <div className=\"grid grid-cols-2 gap-2\">\n              {loading ? (\n                <div className=\"col-span-2 bg-white rounded-2xl border p-4 text-sm text-gray-600\">\n                  Loading...\n                </div>\n              ) : (\n                <>\n                  {filtered.map((p: any) => {\n                    const imgUrl = getPrimaryImageUrl(p.id);\n\n                    const vars = getVariantsFor(p.id);\n                    const hasVariants = vars.length > 0;\n\n                    const selectedVariantId =\n                      selectedVariantByProduct[p.id] ??\n                      getDefaultVariantId(p.id);\n\n                    const selectedV = getVariantById(\n                      p.id,\n                      selectedVariantId\n                    );\n                    const price = getVariantPrice(\n                      p.id,\n                      selectedVariantId,\n                      p.base_price\n                    );\n                    const mrp = getVariantMRP(\n                      p.id,\n                      selectedVariantId\n                    );\n\n                    const label = selectedV?.label ?? \"\";\n                    const offPct =\n                      mrp && price\n                        ? Math.round(\n                            ((mrp - price) / mrp) * 100\n                          )\n                        : null;\n\n                    const chips = vars.slice(0, 3);\n                    const extraCount = Math.max(\n                      0,\n                      vars.length - chips.length\n                    );\n\n                    return (\n                      <div\n                        key={p.id}\n                        className={`rounded-2xl shadow-sm overflow-hidden border relative flex flex-col ${\n                          p.is_concept\n                            ? \"bg-[#FFFDF4] border-[#F4D79B]\"\n                            : \"bg-white border-gray-200\"\n                        }`}\n                      >\n                        <div className=\"relative pt-3 px-3 pb-1 flex-1\">\n                          {label ? (\n                            <div className=\"absolute right-2 bottom-2 text-[10px] px-2 py-0.5 rounded-full bg-black/70 text-white\">\n                              {label}\n                            </div>\n                          ) : null}\n\n                          {justAddedId === p.id ? (\n                            <div className=\"absolute left-2 top-2 text-[11px] px-2 py-1 rounded-full bg-green-600 text-white font-bold shadow\">\n                              {lang === \"en\"\n                                ? \"Added ✓\"\n                                : \"Waa la daray ✓\"}\n                            </div>\n                          ) : null}\n\n                          <Link\n                            href={`/product/${p.slug}`}\n                            className=\"block\"\n                          >\n                            <Image\n                              src={imgUrl}\n                              alt={p.name}\n                              width={220}\n                              height={220}\n                              className={`mx-auto h-32 object-contain w-full ${\n                                p.is_concept\n                                  ? \"drop-shadow-[0_2px_4px_rgba(0,0,0,0.25)]\"\n                                  : \"\"\n                              }`}\n                            />\n                          </Link>\n                        </div>\n\n                        <div className=\"px-3 pb-2\">\n                          <div className=\"text-[13px] font-semibold text-gray-900 line-clamp-2 min-h-[32px]\">\n                            {p.name}\n                          </div>\n\n\n                          {hasVariants ? (\n                            <div className=\"mt-1 flex flex-wrap gap-1.5\">\n                              {chips.map((v: any) => {\n                                const active =\n                                  v.id === selectedVariantId;\n                                return (\n                                  <button\n                                    key={v.id}\n                                    onClick={() =>\n                                      setSelectedVariantByProduct(\n                                        (prev) => ({\n                                          ...prev,\n                                          [p.id]: v.id,\n                                        })\n                                      )\n                                    }\n                                    className={`h-7 px-2 rounded-full border text-[11px] font-semibold ${\n                                      active\n                                        ? \"border-[#0B6EA9] bg-[#EAF4FB] text-[#0B6EA9]\"\n                                        : \"bg-white text-gray-700\"\n                                    }`}\n                                  >\n                                    {v.label}\n                                  </button>\n                                );\n                              })}\n\n                              {extraCount > 0 ? (\n                                <Link\n                                  href={`/product/${p.slug}`}\n                                  className=\"h-7 px-2 rounded-full border text-[11px] font-semibold bg-white text-[#0B6EA9] grid place-items-center\"\n                                >\n                                  +{extraCount}{\" \"}\n                                  {lang === \"en\"\n                                    ? \"more\"\n                                    : \"kale\"}\n                                </Link>\n                              ) : null}\n                            </div>\n                          ) : (\n                            <div className=\"h-[10px]\" />\n                          )}\n\n                          <div className=\"mt-1 flex items-end gap-2\">\n                            <div className=\"text-[16px] font-extrabold text-gray-900 leading-none\">\n                              {money(price)}\n                            </div>\n                            {mrp ? (\n                              <div className=\"text-[11px] text-gray-400 line-through\">\n                                {money(mrp)}\n                              </div>\n                            ) : null}\n                          </div>\n\n                          {offPct ? (\n                            <div className=\"text-[12px] font-semibold text-red-600\">\n                              {offPct}%\n                              {lang === \"en\"\n                                ? \" Off\"\n                                : \" Dhimis\"}\n                            </div>\n                          ) : (\n                            <div className=\"h-[8px]\" />\n                          )}\n\n                          <div className=\"mt-1\">\n                            <ProductAdd\n                              productId={p.id}\n                              basePrice={p.base_price}\n                              selectedVariantId={\n                                selectedVariantId\n                              }\n                            />\n                          </div>\n\n<div className=\"mt-1 text-[11px] font-semibold text-[#0F8A4B]\">\n  ⚡ {lang === \"en\" ? \"Quick\" : \"Degdeg\"}\n</div>\n                        </div>\n                      </div>\n                    );\n                  })}\n\n                  {filtered.length === 0 && (\n                    <div className=\"col-span-2 bg-white rounded-2xl border p-4 text-sm text-gray-600\">\n                      {lang === \"en\"\n                        ? \"No products found in this section.\"\n                        : \"Alaab lagama helin qaybtaan.\"}\n                    </div>\n                  )}\n                </>\n              )}\n            </div>\n          </div>\n        </section>\n\n        {/* STICKY CART BAR */}\n        {cartTotals.count > 0 && (\n          <div className=\"fixed left-0 right-0 bottom-4 z-40\">\n            <div className=\"mx-auto max-w-md px-3\">\n              <Link\n                href=\"/cart\"\n                className=\"flex items-center justify-between bg-[#0B6EA9] text-white rounded-2xl px-4 py-3 shadow-lg\"\n              >\n                <div>\n                  <div className=\"text-xs opacity-90\">\n                    {cartTotals.count}{\" \"}\n                    {lang === \"en\" ? \"item\" : \"shay\"}\n                    {cartTotals.count > 1 ? \"s\" : \"\"}{\" \"}\n                    {lang === \"en\"\n                      ? \"in cart\"\n                      : \"gaadhiga ku jira\"}\n                  </div>\n                  <div className=\"text-lg font-extrabold\">\n                    {money(cartTotals.total)}\n                  </div>\n                </div>\n\n                <div className=\"text-right leading-tight font-extrabold\">\n                  <div>\n                    {lang === \"en\"\n                      ? \"Go to Cart →\"\n                      : \"U gudub Gaadhiga →\"}\n                  </div>\n                  <div className=\"text-[10px] opacity-80\">\n                    {lang === \"en\"\n                      ? \"U gudub Gaadhiga\"\n                      : \"Go to Cart\"}\n                  </div>\n                </div>\n              </Link>\n            </div>\n          </div>\n        )}\n      </main>\n    </>\n  );\n}"],"names":[],"mappings":"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"}}]
}