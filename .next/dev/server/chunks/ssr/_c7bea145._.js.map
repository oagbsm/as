{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/a./mato1/lib/supabaseClient.ts"],"sourcesContent":["import { createClient } from \"@supabase/supabase-js\";\n\nexport const supabase = createClient(\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\n  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\n);\n"],"names":[],"mappings":";;;;AAAA;;AAEO,MAAM,WAAW,IAAA,8LAAY"}},
    {"offset": {"line": 15, "column": 0}, "map": {"version":3,"sources":["file:///Users/a./mato1/app/admin/add-product/page.tsx"],"sourcesContent":["// app/admin/add-product/page.tsx\n\"use client\";\n\nimport { useEffect, useState, FormEvent } from \"react\";\nimport { supabase } from \"@/lib/supabaseClient\";\n\ntype Category = {\n  id: number;\n  name_en: string;\n  slug: string;\n};\n\ntype Subcategory = {\n  id: number;\n  category_id: number;\n  name_en: string;\n  slug: string;\n};\n\ntype Brand = {\n  id: number;\n  name: string;\n  slug: string;\n};\n\ntype VariantForm = {\n  label: string;\n  price: string;\n  mrp: string;\n  stock: string;\n};\n\nfunction slugify(value: string): string {\n  return value\n    .toLowerCase()\n    .trim()\n    .replace(/[^a-z0-9]+/g, \"-\")\n    .replace(/^-+|-+$/g, \"\");\n}\n\nexport default function AddProductPage() {\n  const [categories, setCategories] = useState<Category[]>([]);\n  const [subcategories, setSubcategories] = useState<Subcategory[]>([]);\n  const [brands, setBrands] = useState<Brand[]>([]);\n\n  const [categoryId, setCategoryId] = useState<number | \"\">(\"\");\n  const [subcategoryId, setSubcategoryId] = useState<number | \"\">(\"\");\n  const [brandId, setBrandId] = useState<number | \"\">(\"\");\n\n  const [name, setName] = useState(\"\");\n  const [slug, setSlug] = useState(\"\");\n  const [slugDirty, setSlugDirty] = useState(false);\n  const [basePrice, setBasePrice] = useState(\"\");\n  const [longDescription, setLongDescription] = useState(\"\");\n  const [isDiscounted, setIsDiscounted] = useState(false);\n  const [tags, setTags] = useState(\"\"); // comma separated\n  const [isActive, setIsActive] = useState(true);\n  const [isConcept, setIsConcept] = useState(false);\n\n  // VARIANTS: allow multiple\n  const [variantRows, setVariantRows] = useState<VariantForm[]>([\n    { label: \"\", price: \"\", mrp: \"\", stock: \"\" },\n  ]);\n\n  // PRIMARY IMAGE: either URL or uploaded file\n  const [imageUrl, setImageUrl] = useState(\"\");\n  const [imageFile, setImageFile] = useState<File | null>(null);\n\n  const [loading, setLoading] = useState(false);\n  const [status, setStatus] = useState<null | { type: \"success\" | \"error\"; message: string }>(\n    null\n  );\n\n  // --- Load reference data on mount ---\n  useEffect(() => {\n    const loadMeta = async () => {\n      const [catRes, subRes, brandRes] = await Promise.all([\n        supabase.from(\"categories\").select(\"id,name_en,slug\").order(\"id\"),\n        supabase.from(\"subcategories\").select(\"id,category_id,name_en,slug\").order(\"id\"),\n        supabase.from(\"brands\").select(\"id,name,slug\").order(\"name\"),\n      ]);\n\n      if (!catRes.error && catRes.data) setCategories(catRes.data as Category[]);\n      if (!subRes.error && subRes.data) setSubcategories(subRes.data as Subcategory[]);\n      if (!brandRes.error && brandRes.data) setBrands(brandRes.data as Brand[]);\n    };\n\n    loadMeta();\n  }, []);\n\n  // auto-generate slug from name until user manually edits slug\n  useEffect(() => {\n    if (!name) {\n      if (!slugDirty) setSlug(\"\");\n      return;\n    }\n    if (slugDirty) return; // user manually edited slug, don't override\n\n    setSlug(slugify(name));\n  }, [name, slugDirty]);\n  const handleCreateBrand = async () => {\n    const name = window.prompt(\"New brand name\");\n    if (!name) return;\n\n    const newSlug = slugify(name);\n\n    const { data, error } = await supabase\n      .from(\"brands\")\n      .insert({ name, slug: newSlug })\n      .select(\"id,name,slug\")\n      .single();\n\n    if (error || !data) {\n      console.error(error);\n      setStatus({\n        type: \"error\",\n        message: \"Failed to create brand. Please try again.\",\n      });\n      return;\n    }\n\n    const brand = data as Brand;\n    setBrands((prev) => [...prev, brand]);\n    setBrandId(brand.id);\n    setStatus({ type: \"success\", message: `Brand \"${brand.name}\" created.` });\n  };\n\n  const filteredSubcategories = subcategories.filter((s) =>\n    categoryId ? s.category_id === Number(categoryId) : true\n  );\n\n  const handleSubmit = async (e: FormEvent) => {\n    e.preventDefault();\n    setStatus(null);\n\n    const missing: string[] = [];\n    if (!name.trim()) missing.push(\"Product name\");\n    if (!slug.trim()) missing.push(\"Slug\");\n    if (!categoryId) missing.push(\"Category\");\n    if (!subcategoryId) missing.push(\"Subcategory\");\n    if (!brandId) missing.push(\"Brand\");\n    if (!basePrice) missing.push(\"Base price\");\n\n    if (missing.length) {\n      setStatus({\n        type: \"error\",\n        message: `Please fill in all required fields: ${missing.join(\", \")}.`,\n      });\n      return;\n    }\n\n    setLoading(true);\n    try {\n      // Insert product\n      const { data: product, error: productError } = await supabase\n        .from(\"products\")\n        .insert({\n          name,\n          slug,\n          long_description: longDescription || \"\",\n          category_id: Number(categoryId),\n          subcategory_id: Number(subcategoryId),\n          brand_id: Number(brandId),\n          is_discounted: isDiscounted,\n          base_price: Number(basePrice),\n          tags: tags\n            ? tags\n                .split(\",\")\n                .map((t) => t.trim())\n                .filter(Boolean)\n            : null,\n          is_active: isActive,\n          is_concept: isConcept,\n        })\n        .select(\"id\")\n        .single();\n\n      if (productError || !product) {\n        setStatus({\n          type: \"error\",\n          message:\n            productError?.message ||\n            \"Failed to create product – check that category, subcategory and brand are valid.\",\n        });\n        setLoading(false);\n        return;\n      }\n\n      const productId = product.id as number;\n\n      // Insert all valid variants (multiple rows)\n      const variantPayloads = variantRows\n        .filter((v) => v.label && v.price)\n        .map((v) => ({\n          product_id: productId,\n          label: v.label.trim(),\n          sku: `${slug}-${v.label.trim().toLowerCase().replace(/[^a-z0-9]+/g, \"-\")}-${Date.now()}`,\n          price: Number(v.price),\n          mrp: v.mrp ? Number(v.mrp) : Number(v.price),\n          stock: v.stock ? Number(v.stock) : 0,\n        }));\n\n      if (variantPayloads.length > 0) {\n        const { error: variantError } = await supabase\n          .from(\"product_variants\")\n          .insert(variantPayloads);\n\n        if (variantError) {\n          console.error(variantError);\n          throw new Error(\"Product created but variants insert failed\");\n        }\n      }\n\n      // Determine final image URL: prefer uploaded file, fallback to manual URL\n      let finalImageUrl = imageUrl.trim() || \"\";\n\n      if (imageFile) {\n        const ext = imageFile.name.split(\".\").pop() || \"jpg\";\n        const filePath = `products/${productId}-${Date.now()}.${ext}`;\n\n        const { data: uploadData, error: uploadError } = await supabase.storage\n          .from(\"product-images\")\n          .upload(filePath, imageFile, {\n            cacheControl: \"3600\",\n            upsert: false,\n          });\n\n        if (uploadError) {\n          console.error(uploadError);\n          throw new Error(\"Product created but image upload failed\");\n        }\n\n        const { data: publicUrlData } = supabase.storage\n          .from(\"product-images\")\n          .getPublicUrl(uploadData.path);\n\n        finalImageUrl = publicUrlData.publicUrl || finalImageUrl;\n      }\n\n      if (finalImageUrl) {\n        const { error: imgError } = await supabase.from(\"product_images\").insert({\n          product_id: productId,\n          url: finalImageUrl,\n          is_primary: true,\n        });\n\n        if (imgError) {\n          console.error(imgError);\n          throw new Error(\"Product created but image insert failed\");\n        }\n      }\n\n      setStatus({ type: \"success\", message: \"Product created successfully.\" });\n\n      // Clear form (keep some defaults for fast multi-entry)\n      setName(\"\");\n      setSlug(\"\");\n      setBasePrice(\"\");\n      setLongDescription(\"\");\n      setIsDiscounted(false);\n      setIsConcept(false);\n      setTags(\"\");\n      setVariantRows([{ label: \"\", price: \"\", mrp: \"\", stock: \"\" }]);\n      setImageUrl(\"\");\n      setImageFile(null);\n      // keep category / subcategory / brand as is to add similar products fast\n    } catch (err: any) {\n      setStatus({ type: \"error\", message: err?.message || \"Something went wrong.\" });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 text-gray-900 px-4 py-6\">\n      <div className=\"max-w-5xl mx-auto\">\n        {/* Header */}\n        <header className=\"mb-4 flex flex-wrap items-center justify-between gap-2\">\n          <div>\n            <h1 className=\"text-xl font-semibold\">Add new product</h1>\n            <p className=\"text-xs text-gray-600 mt-1\">\n              Fill in the basic details, variants, and image. Keep it simple.\n            </p>\n          </div>\n          <span className=\"text-[11px] px-2 py-1 rounded border border-gray-300 text-gray-600\">\n            MatoMart · Admin\n          </span>\n        </header>\n\n        {/* Status */}\n        {status && (\n          <div\n            className={`mb-4 rounded border px-3 py-2 text-xs ${\n              status.type === \"success\"\n                ? \"border-green-500 bg-green-50 text-green-800\"\n                : \"border-red-500 bg-red-50 text-red-800\"\n            }`}\n          >\n            {status.message}\n          </div>\n        )}\n\n        <form onSubmit={handleSubmit} className=\"space-y-6 text-sm\">\n          {/* Basic info */}\n          <section className=\"space-y-3\">\n            <h2 className=\"text-xs font-semibold uppercase text-gray-700\">Basic info</h2>\n            <div className=\"grid gap-3 md:grid-cols-2\">\n              <div className=\"flex flex-col gap-1\">\n                <label className=\"text-xs text-gray-600\">Product name *</label>\n                <input\n                  value={name}\n                  onChange={(e) => setName(e.target.value)}\n                  className=\"border rounded px-2 py-1.5 text-sm bg-white\"\n                  placeholder=\"Baraka Corn Flakes 500g\"\n                />\n              </div>\n              <div className=\"flex flex-col gap-1\">\n                <label className=\"text-xs text-gray-600\">Slug (URL) *</label>\n                <input\n                  value={slug}\n                  onChange={(e) => {\n                    const val = e.target.value;\n                    setSlug(val);\n                    // mark slug as manually edited if it has any content\n                    setSlugDirty(val.trim().length > 0);\n                  }}\n                  className=\"border rounded px-2 py-1.5 text-sm bg-white\"\n                  placeholder=\"baraka-corn-flakes-500g\"\n                />\n                <p className=\"text-[11px] text-gray-500\">\n                  /product/{slug || \"slug\"}\n                </p>\n              </div>\n            </div>\n\n            <div className=\"flex flex-col gap-1\">\n              <label className=\"text-xs text-gray-600\">Long description</label>\n              <textarea\n                value={longDescription}\n                onChange={(e) => setLongDescription(e.target.value)}\n                rows={3}\n                className=\"border rounded px-2 py-1.5 text-sm bg-white\"\n                placeholder=\"Describe the product...\"\n              />\n            </div>\n          </section>\n\n          {/* Classification & pricing */}\n          <section className=\"space-y-3\">\n            <h2 className=\"text-xs font-semibold uppercase text-gray-700\">Category & pricing</h2>\n            <div className=\"grid gap-3 md:grid-cols-3\">\n              <div className=\"flex flex-col gap-1\">\n                <label className=\"text-xs text-gray-600\">Category *</label>\n                <select\n                  value={categoryId}\n                  onChange={(e) =>\n                    setCategoryId(e.target.value ? Number(e.target.value) : \"\")\n                  }\n                  className=\"border rounded px-2 py-1.5 text-sm bg-white\"\n                >\n                  <option value=\"\">Select</option>\n                  {categories.map((c) => (\n                    <option key={c.id} value={c.id}>\n                      {c.name_en}\n                    </option>\n                  ))}\n                </select>\n              </div>\n\n              <div className=\"flex flex-col gap-1\">\n                <label className=\"text-xs text-gray-600\">Subcategory *</label>\n                <select\n                  value={subcategoryId}\n                  onChange={(e) =>\n                    setSubcategoryId(e.target.value ? Number(e.target.value) : \"\")\n                  }\n                  className=\"border rounded px-2 py-1.5 text-sm bg-white\"\n                >\n                  <option value=\"\">Select</option>\n                  {filteredSubcategories.map((s) => (\n                    <option key={s.id} value={s.id}>\n                      {s.name_en}\n                    </option>\n                  ))}\n                </select>\n              </div>\n\n              <div className=\"flex flex-col gap-1\">\n                <label className=\"text-xs text-gray-600\">Brand *</label>\n                <div className=\"flex gap-2 items-center\">\n                  <select\n                    value={brandId}\n                    onChange={(e) =>\n                      setBrandId(e.target.value ? Number(e.target.value) : \"\")\n                    }\n                    className=\"border rounded px-2 py-1.5 text-sm bg-white flex-1\"\n                  >\n                    <option value=\"\">Select</option>\n                    {brands.map((b) => (\n                      <option key={b.id} value={b.id}>\n                        {b.name}\n                      </option>\n                    ))}\n                  </select>\n                  <button\n                    type=\"button\"\n                    onClick={handleCreateBrand}\n                    className=\"text-[11px] px-2 py-1 border rounded bg-white text-gray-700 hover:bg-gray-100\"\n                  >\n                    + New\n                  </button>\n                </div>\n              </div>\n            </div>\n\n            <div className=\"grid gap-3 md:grid-cols-4 items-center\">\n              <div className=\"flex flex-col gap-1\">\n                <label className=\"text-xs text-gray-600\">Base price (USD) *</label>\n                <input\n                  type=\"number\"\n                  min=\"0\"\n                  step=\"0.01\"\n                  value={basePrice}\n                  onChange={(e) => setBasePrice(e.target.value)}\n                  className=\"border rounded px-2 py-1.5 text-sm bg-white\"\n                  placeholder=\"3.50\"\n                />\n              </div>\n\n              <label className=\"flex items-center gap-2 text-xs text-gray-700\">\n                <input\n                  id=\"discounted\"\n                  type=\"checkbox\"\n                  checked={isDiscounted}\n                  onChange={(e) => setIsDiscounted(e.target.checked)}\n                />\n                Discounted item\n              </label>\n\n              <label className=\"flex items-center gap-2 text-xs text-gray-700\">\n                <input\n                  id=\"active\"\n                  type=\"checkbox\"\n                  checked={isActive}\n                  onChange={(e) => setIsActive(e.target.checked)}\n                />\n                Active (visible)\n              </label>\n\n              <label className=\"flex items-center gap-2 text-xs text-gray-700\">\n                <input\n                  id=\"concept\"\n                  type=\"checkbox\"\n                  checked={isConcept}\n                  onChange={(e) => setIsConcept(e.target.checked)}\n                />\n                Concept / import-only\n              </label>\n            </div>\n\n            <div className=\"flex flex-col gap-1\">\n              <label className=\"text-xs text-gray-600\">Tags (comma separated)</label>\n              <input\n                value={tags}\n                onChange={(e) => setTags(e.target.value)}\n                className=\"border rounded px-2 py-1.5 text-sm bg-white\"\n                placeholder=\"corn flakes, breakfast, baraka\"\n              />\n            </div>\n          </section>\n\n          {/* Variants and image side by side */}\n          <section className=\"grid gap-6 md:grid-cols-2\">\n            {/* Variants */}\n            <div className=\"space-y-3\">\n              <h2 className=\"text-xs font-semibold uppercase text-gray-700\">Variants</h2>\n              <p className=\"text-[11px] text-gray-600\">\n                Add one or more variants (e.g. 500g, 1kg, 6-pack).\n              </p>\n\n              <div className=\"space-y-3\">\n                {variantRows.map((row, idx) => (\n                  <div key={idx} className=\"border rounded px-3 py-2 space-y-2 bg-white\">\n                    <div className=\"flex items-center gap-2\">\n                      <div className=\"flex-1 flex flex-col gap-1\">\n                        <label className=\"text-xs text-gray-600\">Label</label>\n                        <input\n                          value={row.label}\n                          onChange={(e) => {\n                            const val = e.target.value;\n                            setVariantRows((prev) => {\n                              const copy = [...prev];\n                              copy[idx] = { ...copy[idx], label: val };\n                              return copy;\n                            });\n                          }}\n                          className=\"border rounded px-2 py-1.5 text-xs bg-white\"\n                          placeholder=\"500g, 1kg, 6-pack...\"\n                        />\n                      </div>\n                      {variantRows.length > 1 && (\n                        <button\n                          type=\"button\"\n                          onClick={() => {\n                            setVariantRows((prev) => prev.filter((_, i) => i !== idx));\n                          }}\n                          className=\"text-[11px] text-red-600\"\n                        >\n                          Remove\n                        </button>\n                      )}\n                    </div>\n\n                    <div className=\"grid gap-2 grid-cols-3\">\n                      <div className=\"flex flex-col gap-1\">\n                        <label className=\"text-xs text-gray-600\">Price</label>\n                        <input\n                          type=\"number\"\n                          min=\"0\"\n                          step=\"0.01\"\n                          value={row.price}\n                          onChange={(e) => {\n                            const val = e.target.value;\n                            setVariantRows((prev) => {\n                              const copy = [...prev];\n                              copy[idx] = { ...copy[idx], price: val };\n                              return copy;\n                            });\n                          }}\n                          className=\"border rounded px-2 py-1.5 text-xs bg-white\"\n                          placeholder=\"3.50\"\n                        />\n                      </div>\n                      <div className=\"flex flex-col gap-1\">\n                        <label className=\"text-xs text-gray-600\">MRP</label>\n                        <input\n                          type=\"number\"\n                          min=\"0\"\n                          step=\"0.01\"\n                          value={row.mrp}\n                          onChange={(e) => {\n                            const val = e.target.value;\n                            setVariantRows((prev) => {\n                              const copy = [...prev];\n                              copy[idx] = { ...copy[idx], mrp: val };\n                              return copy;\n                            });\n                          }}\n                          className=\"border rounded px-2 py-1.5 text-xs bg-white\"\n                          placeholder=\"4.00\"\n                        />\n                      </div>\n                      <div className=\"flex flex-col gap-1\">\n                        <label className=\"text-xs text-gray-600\">Stock</label>\n                        <input\n                          type=\"number\"\n                          min=\"0\"\n                          step=\"1\"\n                          value={row.stock}\n                          onChange={(e) => {\n                            const val = e.target.value;\n                            setVariantRows((prev) => {\n                              const copy = [...prev];\n                              copy[idx] = { ...copy[idx], stock: val };\n                              return copy;\n                            });\n                          }}\n                          className=\"border rounded px-2 py-1.5 text-xs bg-white\"\n                          placeholder=\"120\"\n                        />\n                      </div>\n                    </div>\n                  </div>\n                ))}\n\n                <button\n                  type=\"button\"\n                  onClick={() =>\n                    setVariantRows((prev) => [\n                      ...prev,\n                      { label: \"\", price: \"\", mrp: \"\", stock: \"\" },\n                    ])\n                  }\n                  className=\"text-[11px] px-3 py-1.5 border border-dashed rounded text-gray-700 bg-white\"\n                >\n                  + Add another variant\n                </button>\n              </div>\n            </div>\n\n            {/* Image */}\n            <div className=\"space-y-3\">\n              <h2 className=\"text-xs font-semibold uppercase text-gray-700\">Primary image</h2>\n              <p className=\"text-[11px] text-gray-600\">\n                Upload from your computer or paste a public image URL.\n              </p>\n\n              <div className=\"space-y-2\">\n                <label className=\"text-xs text-gray-600\">Upload from computer</label>\n                <input\n                  type=\"file\"\n                  accept=\"image/*\"\n                  onChange={(e) => {\n                    const file = e.target.files?.[0] || null;\n                    setImageFile(file);\n                  }}\n                  className=\"block w-full text-xs text-gray-700\"\n                />\n              </div>\n\n              <div className=\"space-y-2\">\n                <label className=\"text-xs text-gray-600\">Or paste image URL</label>\n                <input\n                  value={imageUrl}\n                  onChange={(e) => setImageUrl(e.target.value)}\n                  className=\"border rounded px-2 py-1.5 text-sm bg-white w-full\"\n                  placeholder=\"https://.../product-images/products/example.webp\"\n                />\n              </div>\n\n              {(imageFile || imageUrl) && (\n                <div className=\"border rounded px-3 py-2 bg-white flex items-center justify-center\">\n                  {/* eslint-disable-next-line @next/next/no-img-element */}\n                  <img\n                    src={imageFile ? URL.createObjectURL(imageFile) : imageUrl}\n                    alt=\"Preview\"\n                    className=\"max-h-40 object-contain\"\n                    onError={(e) => {\n                      (e.target as HTMLImageElement).style.display = \"none\";\n                    }}\n                  />\n                </div>\n              )}\n            </div>\n          </section>\n\n          {/* Submit */}\n          <div className=\"flex justify-end pt-2\">\n            <button\n              type=\"submit\"\n              disabled={loading}\n              className=\"px-4 py-2 text-sm rounded bg-blue-600 text-white disabled:opacity-60\"\n            >\n              {loading ? \"Saving...\" : \"Save product\"}\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n}"],"names":[],"mappings":"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"}}]
}