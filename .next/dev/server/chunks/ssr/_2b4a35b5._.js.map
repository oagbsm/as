{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/a./mato1/lib/supabaseClient.ts"],"sourcesContent":["import { createClient } from \"@supabase/supabase-js\";\n\nexport const supabase = createClient(\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\n  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\n);\n"],"names":[],"mappings":";;;;AAAA;;AAEO,MAAM,WAAW,IAAA,8LAAY"}},
    {"offset": {"line": 15, "column": 0}, "map": {"version":3,"sources":["file:///Users/a./mato1/lib/db.ts"],"sourcesContent":["// lib/db.ts\nimport { supabase } from \"@/lib/supabaseClient\";\n\n/* =========================\n   Helpers\n========================= */\n\nexport function safeImg(src: any) {\n  const s = String(src ?? \"\").trim();\n  if (!s) return \"/example.png\";\n  if (s.startsWith(\"/\")) return s;\n  if (s.startsWith(\"http://\") || s.startsWith(\"https://\")) return s;\n  return \"/example.png\";\n}\n\n/* =========================\n   Types\n========================= */\n\ntype CategoryRow = {\n  id: number;\n  slug: string;\n  img: string | null;\n  name_so: string;\n  name_en: string;\n};\n\ntype SubcategoryRow = {\n  id: number;\n  category_id: number;\n  slug: string;\n  img: string | null;\n  name_so: string;\n  name_en: string;\n};\n\nexport type ProductRow = {\n  id: number;\n  name: string;\n  slug: string;\n  base_price: number; // numeric NOT NULL in DB\n  long_description: string; // NOT NULL in DB\n  category_id: number;\n  subcategory_id: number;\n  brand_id: number;\n  is_discounted: boolean;\n  tags?: string[] | null;\n  is_active: boolean;\n};\nexport type VariantRow = {\n  id: number;\n  product_id: number;\n  label: string;\n  price: number;\n\n  // optional if you track stock\n  stock?: number | null;\n};\n\n/* =========================\n   Home (categories + subcats)\n========================= */\n\nexport async function getCategoriesWithSubcategories() {\n  const { data: cats, error: catErr } = await supabase\n    .from(\"categories\")\n    .select(\"id,slug,img,name_so,name_en\")\n    .order(\"id\", { ascending: true });\n\n  if (catErr) throw catErr;\n\n  const { data: subs, error: subErr } = await supabase\n    .from(\"subcategories\")\n    .select(\"id,category_id,slug,img,name_so,name_en\")\n    .order(\"id\", { ascending: true });\n\n  if (subErr) throw subErr;\n\n  const categories = (cats ?? []) as CategoryRow[];\n  const subcategories = (subs ?? []) as SubcategoryRow[];\n\n  return categories.map((cat) => ({\n    ...cat,\n    subcats: subcategories.filter((s) => s.category_id === cat.id),\n  }));\n}\n\n/* =========================\n   Search page: fetch everything\n========================= */\n\nexport async function fetchAllCategories() {\n  const { data, error } = await supabase.from(\"categories\").select(\"*\").order(\"id\");\n  if (error) throw error;\n  return data ?? [];\n}\n\nexport async function fetchAllSubcategories() {\n  const { data, error } = await supabase.from(\"subcategories\").select(\"*\").order(\"id\");\n  if (error) throw error;\n  return data ?? [];\n}\n\nexport async function fetchAllProducts() {\n  const { data, error } = await supabase.from(\"products\").select(\"*\").order(\"id\");\n  if (error) throw error;\n  return data ?? [];\n}\n\nexport async function fetchAllProductVariants() {\n  const { data, error } = await supabase.from(\"product_variants\").select(\"*\").order(\"id\");\n  if (error) throw error;\n  return data ?? [];\n}\n\nexport async function fetchAllProductImages() {\n  const { data, error } = await supabase\n    .from(\"product_images\")\n    .select(\"*\")\n    .order(\"is_primary\", { ascending: false });\n  if (error) throw error;\n  return data ?? [];\n}\n\n/* =========================\n   Subcategory page helpers\n========================= */\n\nexport async function fetchSubcategoryBySlug(slug: string) {\n  const { data, error } = await supabase\n    .from(\"subcategories\")\n    .select(\"*\")\n    .eq(\"slug\", slug)\n    .maybeSingle();\n\n  if (error) {\n    console.error(\"fetchSubcategoryBySlug error:\", { slug, error });\n    throw error;\n  }\n\n  return data;\n}\nexport async function fetchBrandsByIds(ids: number[]) {\n  try {\n    const clean = Array.from(\n      new Set((ids || []).map((x) => Number(x)).filter((n) => Number.isFinite(n)))\n    );\n    if (!clean.length) return [];\n\n    const { data, error } = await supabase\n      .from(\"brands\")\n      .select(\"id,name,slug\")\n      .in(\"id\", clean)\n      .order(\"name\", { ascending: true });\n\n    if (error) {\n      console.error(\"fetchBrandsByIds error\", error);\n      return [];\n    }\n\n    return data ?? [];\n  } catch (e) {\n    console.error(\"fetchBrandsByIds exception\", e);\n    return [];\n  }\n}\n\nexport async function fetchProductBySlug(slug: string) {\n  const { data, error } = await supabase\n    .from(\"products\")\n    .select(\"*\")\n    .eq(\"slug\", slug)\n    .maybeSingle(); // ‚úÖ doesn't throw when 0 rows\n\n  if (error) {\n    console.error(\"fetchProductBySlug error:\", { slug, error });\n    throw error; // ‚úÖ stop masking real errors as 404\n  }\n\n  return data as ProductRow | null;\n}\n\nexport async function fetchProductsBySubcategoryId(subcategoryId: number) {\n  const { data, error } = await supabase\n    .from(\"products\")\n    .select(\"*\")\n    .eq(\"subcategory_id\", subcategoryId)\n    .order(\"id\", { ascending: true });\n\n  if (error) throw error;\n  return data ?? [];\n}\n\n/**\n * If you don't have subsubcategories yet, you can keep this returning []\n * OR create the table and remove the try/catch.\n */\nexport async function fetchSubSubcategoriesBySubcategoryId(subcategoryId: number) {\n  const { data, error } = await supabase\n    .from(\"subsubcategories\")\n    .select(\"*\")\n    .eq(\"subcategory_id\", subcategoryId)\n    .order(\"id\", { ascending: true });\n\n  // If the table doesn't exist yet, you can return [] instead of throwing.\n  if (error) {\n    // Uncomment next line if you prefer hard-fail:\n    // throw error;\n    return [];\n  }\n  return data ?? [];\n}\n\n/* =========================\n   Product page helpers\n========================= */\n\n\nexport async function fetchSubcategoryById(id: number) {\n  const { data, error } = await supabase.from(\"subcategories\").select(\"*\").eq(\"id\", id).single();\n  if (error) return null;\n  return data;\n}\n\n/**\n * IMPORTANT: object signature (fixes your 22P02 crash).\n */\nexport async function fetchRelatedProducts(args: {\n  subcategoryId: number;\n  excludeProductId: number;\n  limit?: number;\n}) {\n  const limit = args.limit ?? 12;\n\n  const { data, error } = await supabase\n    .from(\"products\")\n    .select(\"*\")\n    .eq(\"subcategory_id\", args.subcategoryId)\n    .neq(\"id\", args.excludeProductId)\n    .limit(limit);\n\n  if (error) throw error;\n  return data ?? [];\n}\n  \n/* =========================\n   Products / Variants / Images: by ids\n========================= */\n\nexport async function getProductsByIds(ids: number[]) {\n  const unique = Array.from(new Set(ids)).filter(Boolean);\n  if (unique.length === 0) return [];\n\n  const { data, error } = await supabase\n    .from(\"products\")\n.select(\n  \"id,name,slug,long_description,category_id,subcategory_id,brand_id,is_discounted,base_price,tags,is_active\"\n).in(\"id\", unique);\n\n  if (error) throw error;\n  return (data ?? []) as ProductRow[];\n}\n\nexport async function getVariantsByIds(ids: number[]) {\n  const unique = Array.from(new Set(ids)).filter((x) => x != null) as number[];\n  if (unique.length === 0) return [];\n\n  const { data, error } = await supabase\n    .from(\"product_variants\")\n    .select(\"id,product_id,label,price,stock\")\n    .in(\"id\", unique);\n\n  if (error) throw error;\n  return (data ?? []) as VariantRow[];\n}\n\nexport async function fetchProductsByIds(ids: number[]) {\n  // alias used by some pages\n  return getProductsByIds(ids);\n}\n\nexport async function fetchVariantsByProductIds(productIds: number[]) {\n  const unique = Array.from(new Set(productIds)).filter(Boolean);\n  if (unique.length === 0) return [];\n\n  const { data, error } = await supabase\n    .from(\"product_variants\")\n    .select(\"*\")\n    .in(\"product_id\", unique)\n    .order(\"price\", { ascending: true });\n\n  if (error) throw error;\n  return data ?? [];\n}\n\nexport async function fetchImagesByProductIds(productIds: number[]) {\n  const unique = Array.from(new Set(productIds)).filter(Boolean);\n  if (unique.length === 0) return [];\n\n  const { data, error } = await supabase\n    .from(\"product_images\")\n    .select(\"*\")\n    .in(\"product_id\", unique)\n    .order(\"is_primary\", { ascending: false });\n\n  if (error) throw error;\n  return data ?? [];\n}\n\n/* =========================\n   Single-ID wrappers (your product page imports these)\n========================= */\n\nexport async function fetchVariantsByProductId(productId: number) {\n  return fetchVariantsByProductIds([productId]);\n}\n\nexport async function fetchImagesByProductId(productId: number) {\n  return fetchImagesByProductIds([productId]);\n}\n\n/* =========================\n   Co-purchase (recommendations)\n========================= */\n\nexport async function fetchBoughtTogetherProductIds(args: {\n  productId: number;\n  limit?: number;\n  excludeIds?: number[];\n}) {\n  const limit = args.limit ?? 12;\n  const exclude = new Set([args.productId, ...(args.excludeIds ?? [])]);\n\n  const { data, error } = await supabase\n    .from(\"copurchase_counts\")\n    .select(\"co_product_id,count\")\n    .eq(\"product_id\", args.productId)\n    .order(\"count\", { ascending: false })\n    .limit(limit * 3);\n\n  if (error) throw error;\n\n  const ids: number[] = [];\n  for (const row of data ?? []) {\n    const id = Number((row as any).co_product_id);\n    if (!exclude.has(id)) ids.push(id);\n    if (ids.length >= limit) break;\n  }\n  return ids;\n}\n\n/* =========================\n   Customers (optional)\n========================= */\n\nexport async function searchCustomers(query: string) {\n  const q = query.trim();\n  if (!q) return [];\n\n  const { data, error } = await supabase\n    .from(\"customers\")\n    .select(\"id,name,phone\")\n    .or(`name.ilike.%${q}%,phone.ilike.%${q}%`)\n    .limit(8);\n\n  if (error) throw error;\n  return data ?? [];\n}\n\n/* =========================\n   Orders (checkout)\n========================= */\n\nexport async function createOrder(args: {\n  customer_id: number | null;\n  delivery: { name: string; phone: string; address: string; note?: string };\n  total_amount: number;\n}) {\n  const { data, error } = await supabase\n    .from(\"orders\")\n    .insert({\n      customer_id: args.customer_id,\n      delivery_name: args.delivery.name,\n      delivery_phone: args.delivery.phone,\n      delivery_address: args.delivery.address,\n      delivery_note: args.delivery.note ?? null,\n      total_amount: args.total_amount,\n      status: \"PENDING\",\n    })\n    .select(\"id\")\n    .single();\n\n  if (error) throw error;\n  return data as { id: number };\n}\n\nexport async function createOrderItems(\n  orderId: number,\n  items: Array<{\n    productId: number;\n    variantId: number | null;\n    qty: number;\n    priceAtPurchase: number;\n  }>\n) {\n  const payload = items.map((it) => ({\n    order_id: orderId,\n    product_id: it.productId,\n    variant_id: it.variantId,\n    quantity: it.qty,\n    price_at_purchase: it.priceAtPurchase,\n  }));\n\n  const { error } = await supabase.from(\"order_items\").insert(payload);\n\n  if (error) {\n    // helpful debugging\n    console.log(\"ORDER_ITEMS_INSERT_ERROR\", error);\n    throw error;\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 292, "column": 0}, "map": {"version":3,"sources":["file:///Users/a./mato1/app/search/page.tsx"],"sourcesContent":["\"use client\";\n\nimport Link from \"next/link\";\nimport Image from \"next/image\";\nimport { useEffect, useMemo, useRef, useState } from \"react\";\nimport { useRouter, useSearchParams } from \"next/navigation\";\n\nimport AddToCartButton from \"@/components/AddToCartButton\";\nimport { useLanguage } from \"@/context/LanguageContext\";\n\nimport {\n  fetchAllCategories,\n  fetchAllSubcategories,\n  fetchAllProducts,\n  fetchAllProductVariants,\n  fetchAllProductImages,\n  safeImg,\n} from \"@/lib/db\";\n\nconst LS_KEY = \"recent_searches_v1\";\nconst MAX_RECENT = 10;\n\nfunction loadRecent(): string[] {\n  try {\n    return JSON.parse(localStorage.getItem(LS_KEY) || \"[]\");\n  } catch {\n    return [];\n  }\n}\n\nfunction saveRecent(term: string) {\n  const t = term.trim();\n  if (!t) return;\n  const prev = loadRecent();\n  const next = [t, ...prev.filter((x) => x.toLowerCase() !== t.toLowerCase())].slice(0, MAX_RECENT);\n  localStorage.setItem(LS_KEY, JSON.stringify(next));\n}\n\nfunction clearRecent() {\n  localStorage.removeItem(LS_KEY);\n}\n\nfunction normalize(s: unknown) {\n  return String(s ?? \"\")\n    .toLowerCase()\n    .trim()\n    .replace(/[-_]+/g, \" \")\n    .replace(/\\s+/g, \" \");\n}\n\nfunction money(n: number) {\n  return `‚Çπ${Number(n ?? 0).toFixed(0)}`;\n}\n\nfunction getLabel(obj: any, lang: \"so\" | \"en\") {\n  const so = obj?.name_so ?? obj?.name ?? \"\";\n  const en = obj?.name_en ?? obj?.name ?? \"\";\n  return lang === \"en\" ? en : so;\n}\n\nfunction scoreProduct(termRaw: string, p: any) {\n  const t = normalize(termRaw);\n  if (!t) return 0;\n\n  const tokens = t.split(\" \").filter(Boolean);\n  const name = normalize(p.name);\n  const slug = normalize(p.slug);\n  const desc = normalize(p.long_description);\n  const tagsStr = Array.isArray(p.tags) ? p.tags.map(normalize).join(\" \") : \"\";\n\n  if (name === t) return 1000;\n  if (slug === t) return 950;\n\n  let score = 0;\n  for (const tok of tokens) {\n    if (name.includes(tok)) score += 150;\n    if (slug.includes(tok)) score += 90;\n    if (tagsStr.includes(tok)) score += 120;\n    if (desc.includes(tok)) score += 20;\n  }\n  if (tokens[0] && name.startsWith(tokens[0])) score += 60;\n\n  return score;\n}\n\nfunction highlightMatch(text: string, termRaw: string) {\n  const t = termRaw.trim();\n  if (!t) return text;\n  const lowerText = text.toLowerCase();\n  const lowerT = t.toLowerCase();\n  const idx = lowerText.indexOf(lowerT);\n  if (idx === -1) return text;\n\n  return (\n    <>\n      {text.slice(0, idx)}\n      <span className=\"font-semibold\">{text.slice(idx, idx + t.length)}</span>\n      {text.slice(idx + t.length)}\n    </>\n  );\n}\n\nexport default function SearchPage() {\n  const { lang } = useLanguage();\n  const inputRef = useRef<HTMLInputElement | null>(null);\n  const router = useRouter();\n\n  const searchParams = useSearchParams();\n  const activeTag = searchParams.get(\"tag\") || \"\";\n  const isResults = !!activeTag;\n\n  const [q, setQ] = useState(\"\");\n  const [recent, setRecent] = useState<string[]>([]);\n\n  // ‚úÖ Supabase data\n  const [categories, setCategories] = useState<any[]>([]);\n  const [subcategories, setSubcategories] = useState<any[]>([]);\n  const [products, setProducts] = useState<any[]>([]);\n  const [productVariants, setProductVariants] = useState<any[]>([]);\n  const [productImages, setProductImages] = useState<any[]>([]);\n\n  useEffect(() => {\n    setRecent(loadRecent());\n    if (activeTag) {\n      setQ(activeTag);\n    }\n    setTimeout(() => inputRef.current?.focus(), 50);\n\n    (async () => {\n      const [cats, subs, prods, vars, imgs] = await Promise.all([\n        fetchAllCategories(),\n        fetchAllSubcategories(),\n        fetchAllProducts(),\n        fetchAllProductVariants(),\n        fetchAllProductImages(),\n      ]);\n\n      setCategories(cats);\n      setSubcategories(subs);\n      setProducts(prods);\n      setProductVariants(vars);\n      setProductImages(imgs);\n    })();\n  }, [activeTag]);\n\n  const term = normalize(isResults ? activeTag : q);\n\n  function getPrimaryImageUrl(productId: number) {\n    const primary = productImages.find((img: any) => img.product_id === productId && img.is_primary);\n    const anyImg = productImages.find((img: any) => img.product_id === productId);\n    return safeImg(primary?.url || anyImg?.url || \"/example.png\");\n  }\n\n  function getBestVariant(productId: number, basePrice?: number) {\n    const vars = productVariants.filter((v: any) => v.product_id === productId);\n    if (vars.length === 0) return { price: basePrice ?? 0, mrp: null as number | null };\n    const best = vars.reduce((min: any, v: any) => (v.price < min.price ? v : min), vars[0]);\n    return { price: best.price, mrp: best.mrp ?? null };\n  }\n\n  const results = useMemo(() => {\n    if (!term) return [];\n\n    const scored = products\n      .map((p: any) => {\n        const cat = categories.find((c: any) => c.id === p.category_id);\n        const sub = subcategories.find((s: any) => s.id === p.subcategory_id);\n\n        const extraHay = normalize(\n          `${cat?.name_so ?? \"\"} ${cat?.name_en ?? \"\"} ${sub?.name_so ?? \"\"} ${sub?.name_en ?? \"\"}`\n        );\n\n        const baseScore = scoreProduct(term, p);\n        const tokens = term.split(\" \").filter(Boolean);\n        const extra = tokens.some((tok) => extraHay.includes(tok)) ? 30 : 0;\n\n        const s = baseScore + extra;\n        return s > 0 ? { p, s } : null;\n      })\n      .filter(Boolean) as any[];\n\n    scored.sort((a, b) => b.s - a.s);\n    return scored.slice(0, 30).map((x) => x.p);\n  }, [term, products, categories, subcategories]);\n\n  const suggestions = useMemo(() => {\n    if (!term) return [];\n\n    const tokens = term.split(\" \").filter(Boolean);\n    const tagScores = new Map<string, number>();\n\n    products.forEach((p: any) => {\n      if (!Array.isArray(p.tags)) return;\n\n      p.tags.forEach((tag: string) => {\n        const normTag = normalize(tag);\n        let score = 0;\n\n        for (const tok of tokens) {\n          if (normTag.includes(tok)) score += 100;\n          if (normTag.startsWith(tok)) score += 50;\n        }\n\n        if (score > 0) {\n          const prev = tagScores.get(tag) ?? 0;\n          if (score > prev) {\n            tagScores.set(tag, score);\n          }\n        }\n      });\n    });\n\n    return Array.from(tagScores.entries())\n      .sort((a, b) => b[1] - a[1])\n      .slice(0, 10)\n      .map(([tag]) => tag);\n  }, [term, products]);\n\n  const popularCats = useMemo(() => categories.slice(0, 8), [categories]);\n  const quickSubs = useMemo(() => subcategories.slice(0, 14), [subcategories]);\n  const recommended = useMemo(() => products.slice(0, 10), [products]);\n\n  function runSearch(tagOverride?: string) {\n    const value = (tagOverride ?? q).trim();\n    if (!value) return;\n    saveRecent(value);\n    setRecent(loadRecent());\n    router.push(`/search/results/${encodeURIComponent(value)}`);\n  }\n\n  return (\n    <main className=\"min-h-screen bg-white text-black pb-24\">\n      {/* FULL SCREEN SEARCH HEADER LIKE REFERENCE UI */}\n      <section className=\"px-3 pt-3 pb-2 border-b border-gray-200\">\n        <div className=\"relative max-w-md mx-auto\">\n          <form\n            onSubmit={(e) => {\n              e.preventDefault();\n              runSearch();\n            }}\n            className=\"flex items-center gap-3\"\n          >\n            {/* Back button */}\n            <button\n              type=\"button\"\n              onClick={() =>\n                typeof window !== \"undefined\" && window.history.length > 1\n                  ? router.back()\n                  : router.push(\"/\")\n              }\n              className=\"h-9 w-9 rounded-full flex items-center justify-center border border-gray-300 bg-white\"\n              aria-label=\"Back\"\n            >\n              <span className=\"text-xl leading-none text-gray-700\">‚Üê</span>\n            </button>\n\n            {/* Search bar */}\n            <div className=\"flex-1 h-11 rounded-full border border-[#4A6FB8] bg-white px-3 flex items-center gap-2\">\n              {/* Logo-style icon */}\n              <div className=\"h-7 w-7 rounded-md border border-[#4A6FB8] flex items-center justify-center\">\n                <span className=\"text-lg font-extrabold text-[#4A6FB8]\">m</span>\n              </div>\n\n              <input\n                ref={inputRef}\n                value={q}\n                onChange={(e) => setQ(e.target.value)}\n                placeholder={lang === \"en\" ? \"Search\" : \"Raadi\"}\n                className=\"flex-1 outline-none text-base\"\n              />\n            </div>\n\n            {/* Clear button on the far right */}\n            <button\n              type=\"button\"\n              onClick={() => {\n                setQ(\"\");\n                if (isResults) {\n                  router.push(\"/search\");\n                }\n              }}\n              className=\"h-9 w-9 rounded-full flex items-center justify-center border border-gray-300 bg-white\"\n              aria-label=\"Clear\"\n            >\n              <span className=\"text-xl leading-none text-gray-700\">‚úï</span>\n            </button>\n          </form>\n\n          {/* DROPDOWN SUGGESTIONS REMOVED */}\n        </div>\n      </section>\n      {!isResults ? (\n        // FULL-PAGE TAG LIST\n        <section className=\"px-3 pt-4 pb-6\">\n          <div className=\"max-w-md mx-auto\">\n            {q && suggestions.length > 0 ? (\n              <div className=\"bg-white rounded-xl border border-gray-200 overflow-hidden\">\n                {suggestions.map((tag: string) => (\n                  <button\n                    key={tag}\n                    type=\"button\"\n                    className=\"w-full flex items-center justify-between px-4 py-3 hover:bg-gray-50 border-b last:border-b-0\"\n                    onClick={() => runSearch(tag)}\n                  >\n                    <div className=\"flex items-center gap-3\">\n                      <div className=\"h-8 w-8 rounded-full border border-gray-400 flex items-center justify-center\">\n                        <span className=\"text-gray-500\">üîç</span>\n                      </div>\n                      <div className=\"text-base text-gray-900 text-left\">\n                        {highlightMatch(tag, q)}\n                      </div>\n                    </div>\n                    <div className=\"text-2xl leading-none text-[#4A6FB8]\">‚Üí</div>\n                  </button>\n                ))}\n              </div>\n            ) : q ? (\n              // NO TAGS FOUND ‚Üí WHATSAPP CONTACT\n              <div className=\"bg-white border rounded-2xl p-4 text-sm text-gray-700\">\n                {lang === \"en\" ? (\n                  <>\n                    No matching tags found for <b>{q}</b>.\n                    <br />\n                    <span className=\"block mt-2 text-gray-700\">\n                      Can&apos;t find what you need? We can try to source it for you.\n                    </span>\n                    <span className=\"block mt-1 text-gray-700\">\n                      Do you want it yourself or know a shop that has it? Tap WhatsApp and send us details.\n                    </span>\n                  </>\n                ) : (\n                  <>\n                    Calaamado ku habboon lagama helin <b>{q}</b>.\n                    <br />\n                    <span className=\"block mt-2 text-gray-700\">\n                      Ma helaysid waxaad raadineysay? Waxaan isku dayi karnaa inaan kuu soo helno.\n                    </span>\n                    <span className=\"block mt-1 text-gray-700\">\n                      Adigu ma rabtaa mise qof ama dukaan ayaad taqaannaa oo haysta? Riix WhatsApp oo\n                      noogu soo dir faahfaahinta.\n                    </span>\n                  </>\n                )}\n\n                <a\n                  href={`https://wa.me/252622073874?text=${encodeURIComponent(\n                    `MatoMart - I can't find this item: \"${q}\". Please help me source it.`\n                  )}`}\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                  className=\"mt-3 inline-flex items-center justify-center rounded-full bg-[#0B6EA9] px-4 py-2 text-sm font-semibold text-white\"\n                >\n                  WhatsApp\n                </a>\n              </div>\n            ) : null}\n          </div>\n        </section>\n      ) : null}\n    </main>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}