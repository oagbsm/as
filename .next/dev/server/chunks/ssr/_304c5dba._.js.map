{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/a./mato1/lib/supabaseClient.ts"],"sourcesContent":["import { createClient } from \"@supabase/supabase-js\";\n\nexport const supabase = createClient(\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\n  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\n);\n"],"names":[],"mappings":";;;;AAAA;;AAEO,MAAM,WAAW,IAAA,8LAAY"}},
    {"offset": {"line": 15, "column": 0}, "map": {"version":3,"sources":["file:///Users/a./mato1/lib/db.ts"],"sourcesContent":["// lib/db.ts\nimport { supabase } from \"@/lib/supabaseClient\";\n\n/* =========================\n   Helpers\n========================= */\n\nexport function safeImg(src: any) {\n  const s = String(src ?? \"\").trim();\n  if (!s) return \"/example.png\";\n  if (s.startsWith(\"/\")) return s;\n  if (s.startsWith(\"http://\") || s.startsWith(\"https://\")) return s;\n  return \"/example.png\";\n}\n\n/* =========================\n   Types\n========================= */\n\ntype CategoryRow = {\n  id: number;\n  slug: string;\n  img: string | null;\n  name_so: string;\n  name_en: string;\n};\n\ntype SubcategoryRow = {\n  id: number;\n  category_id: number;\n  slug: string;\n  img: string | null;\n  name_so: string;\n  name_en: string;\n};\n\nexport type ProductRow = {\n  id: number;\n  name: string;\n  slug: string;\n  base_price: number; // numeric NOT NULL in DB\n  long_description: string; // NOT NULL in DB\n  category_id: number;\n  subcategory_id: number;\n  brand_id: number;\n  is_discounted: boolean;\n  tags?: string[] | null;\n  is_active: boolean;\n};\nexport type VariantRow = {\n  id: number;\n  product_id: number;\n  label: string;\n  price: number;\n\n  // optional if you track stock\n  stock?: number | null;\n};\n\n/* =========================\n   Home (categories + subcats)\n========================= */\n\nexport async function getCategoriesWithSubcategories() {\n  const { data: cats, error: catErr } = await supabase\n    .from(\"categories\")\n    .select(\"id,slug,img,name_so,name_en\")\n    .order(\"id\", { ascending: true });\n\n  if (catErr) throw catErr;\n\n  const { data: subs, error: subErr } = await supabase\n    .from(\"subcategories\")\n    .select(\"id,category_id,slug,img,name_so,name_en\")\n    .order(\"id\", { ascending: true });\n\n  if (subErr) throw subErr;\n\n  const categories = (cats ?? []) as CategoryRow[];\n  const subcategories = (subs ?? []) as SubcategoryRow[];\n\n  return categories.map((cat) => ({\n    ...cat,\n    subcats: subcategories.filter((s) => s.category_id === cat.id),\n  }));\n}\n\n/* =========================\n   Search page: fetch everything\n========================= */\n\nexport async function fetchAllCategories() {\n  const { data, error } = await supabase.from(\"categories\").select(\"*\").order(\"id\");\n  if (error) throw error;\n  return data ?? [];\n}\n\nexport async function fetchAllSubcategories() {\n  const { data, error } = await supabase.from(\"subcategories\").select(\"*\").order(\"id\");\n  if (error) throw error;\n  return data ?? [];\n}\n\nexport async function fetchAllProducts() {\n  const { data, error } = await supabase.from(\"products\").select(\"*\").order(\"id\");\n  if (error) throw error;\n  return data ?? [];\n}\n\nexport async function fetchAllProductVariants() {\n  const { data, error } = await supabase.from(\"product_variants\").select(\"*\").order(\"id\");\n  if (error) throw error;\n  return data ?? [];\n}\n\nexport async function fetchAllProductImages() {\n  const { data, error } = await supabase\n    .from(\"product_images\")\n    .select(\"*\")\n    .order(\"is_primary\", { ascending: false });\n  if (error) throw error;\n  return data ?? [];\n}\n\n/* =========================\n   Subcategory page helpers\n========================= */\n\nexport async function fetchSubcategoryBySlug(slug: string) {\n  const { data, error } = await supabase\n    .from(\"subcategories\")\n    .select(\"*\")\n    .eq(\"slug\", slug)\n    .maybeSingle();\n\n  if (error) {\n    console.error(\"fetchSubcategoryBySlug error:\", { slug, error });\n    throw error;\n  }\n\n  return data;\n}\nexport async function fetchBrandsByIds(ids: number[]) {\n  try {\n    const clean = Array.from(\n      new Set((ids || []).map((x) => Number(x)).filter((n) => Number.isFinite(n)))\n    );\n    if (!clean.length) return [];\n\n    const { data, error } = await supabase\n      .from(\"brands\")\n      .select(\"id,name,slug\")\n      .in(\"id\", clean)\n      .order(\"name\", { ascending: true });\n\n    if (error) {\n      console.error(\"fetchBrandsByIds error\", error);\n      return [];\n    }\n\n    return data ?? [];\n  } catch (e) {\n    console.error(\"fetchBrandsByIds exception\", e);\n    return [];\n  }\n}\n\nexport async function fetchProductBySlug(slug: string) {\n  const { data, error } = await supabase\n    .from(\"products\")\n    .select(\"*\")\n    .eq(\"slug\", slug)\n    .maybeSingle(); // ‚úÖ doesn't throw when 0 rows\n\n  if (error) {\n    console.error(\"fetchProductBySlug error:\", { slug, error });\n    throw error; // ‚úÖ stop masking real errors as 404\n  }\n\n  return data as ProductRow | null;\n}\n\nexport async function fetchProductsBySubcategoryId(subcategoryId: number) {\n  const { data, error } = await supabase\n    .from(\"products\")\n    .select(\"*\")\n    .eq(\"subcategory_id\", subcategoryId)\n    .order(\"id\", { ascending: true });\n\n  if (error) throw error;\n  return data ?? [];\n}\n\n/**\n * If you don't have subsubcategories yet, you can keep this returning []\n * OR create the table and remove the try/catch.\n */\nexport async function fetchSubSubcategoriesBySubcategoryId(subcategoryId: number) {\n  const { data, error } = await supabase\n    .from(\"subsubcategories\")\n    .select(\"*\")\n    .eq(\"subcategory_id\", subcategoryId)\n    .order(\"id\", { ascending: true });\n\n  // If the table doesn't exist yet, you can return [] instead of throwing.\n  if (error) {\n    // Uncomment next line if you prefer hard-fail:\n    // throw error;\n    return [];\n  }\n  return data ?? [];\n}\n\n/* =========================\n   Product page helpers\n========================= */\n\n\nexport async function fetchSubcategoryById(id: number) {\n  const { data, error } = await supabase.from(\"subcategories\").select(\"*\").eq(\"id\", id).single();\n  if (error) return null;\n  return data;\n}\n\n/**\n * IMPORTANT: object signature (fixes your 22P02 crash).\n */\nexport async function fetchRelatedProducts(args: {\n  subcategoryId: number;\n  excludeProductId: number;\n  limit?: number;\n}) {\n  const limit = args.limit ?? 12;\n\n  const { data, error } = await supabase\n    .from(\"products\")\n    .select(\"*\")\n    .eq(\"subcategory_id\", args.subcategoryId)\n    .neq(\"id\", args.excludeProductId)\n    .limit(limit);\n\n  if (error) throw error;\n  return data ?? [];\n}\n  \n/* =========================\n   Products / Variants / Images: by ids\n========================= */\n\nexport async function getProductsByIds(ids: number[]) {\n  const unique = Array.from(new Set(ids)).filter(Boolean);\n  if (unique.length === 0) return [];\n\n  const { data, error } = await supabase\n    .from(\"products\")\n.select(\n  \"id,name,slug,long_description,category_id,subcategory_id,brand_id,is_discounted,base_price,tags,is_active\"\n).in(\"id\", unique);\n\n  if (error) throw error;\n  return (data ?? []) as ProductRow[];\n}\n\nexport async function getVariantsByIds(ids: number[]) {\n  const unique = Array.from(new Set(ids)).filter((x) => x != null) as number[];\n  if (unique.length === 0) return [];\n\n  const { data, error } = await supabase\n    .from(\"product_variants\")\n    .select(\"id,product_id,label,price,stock\")\n    .in(\"id\", unique);\n\n  if (error) throw error;\n  return (data ?? []) as VariantRow[];\n}\n\nexport async function fetchProductsByIds(ids: number[]) {\n  // alias used by some pages\n  return getProductsByIds(ids);\n}\n\nexport async function fetchVariantsByProductIds(productIds: number[]) {\n  const unique = Array.from(new Set(productIds)).filter(Boolean);\n  if (unique.length === 0) return [];\n\n  const { data, error } = await supabase\n    .from(\"product_variants\")\n    .select(\"*\")\n    .in(\"product_id\", unique)\n    .order(\"price\", { ascending: true });\n\n  if (error) throw error;\n  return data ?? [];\n}\n\nexport async function fetchImagesByProductIds(productIds: number[]) {\n  const unique = Array.from(new Set(productIds)).filter(Boolean);\n  if (unique.length === 0) return [];\n\n  const { data, error } = await supabase\n    .from(\"product_images\")\n    .select(\"*\")\n    .in(\"product_id\", unique)\n    .order(\"is_primary\", { ascending: false });\n\n  if (error) throw error;\n  return data ?? [];\n}\n\n/* =========================\n   Single-ID wrappers (your product page imports these)\n========================= */\n\nexport async function fetchVariantsByProductId(productId: number) {\n  return fetchVariantsByProductIds([productId]);\n}\n\nexport async function fetchImagesByProductId(productId: number) {\n  return fetchImagesByProductIds([productId]);\n}\n\n/* =========================\n   Co-purchase (recommendations)\n========================= */\n\nexport async function fetchBoughtTogetherProductIds(args: {\n  productId: number;\n  limit?: number;\n  excludeIds?: number[];\n}) {\n  const limit = args.limit ?? 12;\n  const exclude = new Set([args.productId, ...(args.excludeIds ?? [])]);\n\n  const { data, error } = await supabase\n    .from(\"copurchase_counts\")\n    .select(\"co_product_id,count\")\n    .eq(\"product_id\", args.productId)\n    .order(\"count\", { ascending: false })\n    .limit(limit * 3);\n\n  if (error) throw error;\n\n  const ids: number[] = [];\n  for (const row of data ?? []) {\n    const id = Number((row as any).co_product_id);\n    if (!exclude.has(id)) ids.push(id);\n    if (ids.length >= limit) break;\n  }\n  return ids;\n}\n\n/* =========================\n   Customers (optional)\n========================= */\n\nexport async function searchCustomers(query: string) {\n  const q = query.trim();\n  if (!q) return [];\n\n  const { data, error } = await supabase\n    .from(\"customers\")\n    .select(\"id,name,phone\")\n    .or(`name.ilike.%${q}%,phone.ilike.%${q}%`)\n    .limit(8);\n\n  if (error) throw error;\n  return data ?? [];\n}\n\n/* =========================\n   Orders (checkout)\n========================= */\n\nexport async function createOrder(args: {\n  customer_id: number | null;\n  delivery: { name: string; phone: string; address: string; note?: string };\n  total_amount: number;\n}) {\n  const { data, error } = await supabase\n    .from(\"orders\")\n    .insert({\n      customer_id: args.customer_id,\n      delivery_name: args.delivery.name,\n      delivery_phone: args.delivery.phone,\n      delivery_address: args.delivery.address,\n      delivery_note: args.delivery.note ?? null,\n      total_amount: args.total_amount,\n      status: \"PENDING\",\n    })\n    .select(\"id\")\n    .single();\n\n  if (error) throw error;\n  return data as { id: number };\n}\n\nexport async function createOrderItems(\n  orderId: number,\n  items: Array<{\n    productId: number;\n    variantId: number | null;\n    qty: number;\n    priceAtPurchase: number;\n  }>\n) {\n  const payload = items.map((it) => ({\n    order_id: orderId,\n    product_id: it.productId,\n    variant_id: it.variantId,\n    quantity: it.qty,\n    price_at_purchase: it.priceAtPurchase,\n  }));\n\n  const { error } = await supabase.from(\"order_items\").insert(payload);\n\n  if (error) {\n    // helpful debugging\n    console.log(\"ORDER_ITEMS_INSERT_ERROR\", error);\n    throw error;\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 292, "column": 0}, "map": {"version":3,"sources":["file:///Users/a./mato1/app/page.tsx"],"sourcesContent":["\"use client\";\n\nimport Image from \"next/image\";\nimport Link from \"next/link\";\nimport { useEffect, useMemo, useRef, useState } from \"react\";\n\nimport { useCart } from \"@/context/CartContext\";\nimport { useLanguage } from \"@/context/LanguageContext\";\nimport {\n  getCategoriesWithSubcategories,\n  getProductsByIds,\n  getVariantsByIds,\n  type ProductRow,\n  type VariantRow,\n} from \"@/lib/db\";\n\nconst HERO_SLIDES = [\n  {\n    id: 1,\n    img: \"https://ecfxrmhrfjqdmqewzrfz.supabase.co/storage/v1/object/public/product-images/ads/ad1.webp\",\n  },\n  {\n    id: 2,\n    img: \"https://ecfxrmhrfjqdmqewzrfz.supabase.co/storage/v1/object/public/product-images/ads/ad5.webp\",\n  },\n  {\n    id: 3,\n    img: \"https://ecfxrmhrfjqdmqewzrfz.supabase.co/storage/v1/object/public/product-images/ads/ad3.webp\",\n  },\n    {\n    id: 4,\n    img: \"https://ecfxrmhrfjqdmqewzrfz.supabase.co/storage/v1/object/public/product-images/ads/ad1.webp\",\n  },\n];\n\nconst PROMO_CARDS = [\n  {\n    id: \"members\",\n    title_en: \"Members Only\",\n    title_so: \"Xubnaha Kaliya\",\n    desc_en: \"Special SHARE prices on 2000+ products.\",\n    desc_so: \"Qiimooyin SHARE oo gaar ah in ka badan 2000 alaab.\",\n  },\n  {\n    id: \"tech\",\n    title_en: \"Tech & Appliances\",\n    title_so: \"Tiknoolaji & Qalab\",\n    desc_en: \"Up to 50% off selected electronics.\",\n    desc_so: \"Illaa 50% dhimis qalabka korontada.\",\n  },\n  {\n    id: \"food\",\n    title_en: \"Food & Pantry\",\n    title_so: \"Cunto & Raashin\",\n    desc_en: \"Stock up on everyday essentials.\",\n    desc_so: \"Kaydi raashinka iyo alaabta maalinlaha ah.\",\n  },\n];\n\nfunction money(n: number) {\n  return `$${Number(n ?? 0).toFixed(2)}`;\n}\n\nfunction PrimarySecondary({\n  primary,\n  secondary,\n  center = true,\n  primaryClass = \"text-[11px] font-medium\",\n  secondaryClass = \"text-[9px] text-gray-500\",\n}: {\n  primary: string;\n  secondary?: string;\n  center?: boolean;\n  primaryClass?: string;\n  secondaryClass?: string;\n}) {\n  return (\n    <div className={`${center ? \"text-center\" : \"text-left\"} leading-tight`}>\n      <div className={primaryClass}>{primary}</div>\n      {secondary ? <div className={secondaryClass}>{secondary}</div> : null}\n    </div>\n  );\n}\n\nconst CATEGORY_BG: Record<string, string> = {\n  groceries: \"bg-[#0E5C1C]\", // darker bold green\n  baby: \"bg-[#F8B8D0]\", // richer baby pink\n  \"health-beauty\": \"bg-[#E89A3D]\", // deeper warm orange/peach\n  household: \"bg-[#8FC5E8]\", // stronger blue\n};\n\nconst CATEGORY_ICON: Record<string, string> = {\n  groceries: \"ü•ï\",\n  baby: \"üë∂\",\n  \"health-beauty\": \"‚ú®\",\n  household: \"üè†\",\n};\n\nfunction getCategoryBg(slug: string | undefined) {\n  if (!slug) return \"bg-[#F3F4F6]\"; // default light gray\n  return CATEGORY_BG[slug] ?? \"bg-[#F3F4F6]\";\n}\n\ntype CartItem = { productId: number; variantId?: number | null; qty: number };\n\nexport default function HomePage() {\n  const sectionRefs = useRef<Record<string, HTMLDivElement | null>>({});\n  const [activeSlide, setActiveSlide] = useState(0);\n\n  const { items } = useCart();\n  const { lang } = useLanguage();\n\n  const [categoryMap, setCategoryMap] = useState<any[]>([]);\n  const [loadingCats, setLoadingCats] = useState(true);\n  const [activeCatSlug, setActiveCatSlug] = useState<string | null>(null);\n  const [compactTopCats, setCompactTopCats] = useState(false);\n\n  useEffect(() => {\n    const t = setInterval(\n      () => setActiveSlide((s) => (s + 1) % HERO_SLIDES.length),\n      3500\n    );\n    return () => clearInterval(t);\n  }, []);\n\n  useEffect(() => {\n    let alive = true;\n    (async () => {\n      try {\n        setLoadingCats(true);\n        const cats = await getCategoriesWithSubcategories();\n        if (!alive) return;\n        setCategoryMap(cats);\n      } catch (e: any) {\n        console.error(\"HOME LOAD CATEGORIES ERROR:\", e);\n      } finally {\n        if (alive) setLoadingCats(false);\n      }\n    })();\n    return () => {\n      alive = false;\n    };\n  }, []);\n\n  // Compact top categories (hide images) when scrolling down\n  useEffect(() => {\n    const handleScroll = () => {\n      if (typeof window === \"undefined\") return;\n      // When user scrolls past ~140px, hide topcat images\n      setCompactTopCats(window.scrollY > 140);\n    };\n\n    handleScroll();\n    window.addEventListener(\"scroll\", handleScroll);\n    return () => window.removeEventListener(\"scroll\", handleScroll);\n  }, []);\n\n  // Observe category sections and update active slug when scrolling\n  useEffect(() => {\n    if (!categoryMap.length) return;\n\n    const observer = new IntersectionObserver(\n      (entries) => {\n        entries.forEach((entry) => {\n          const slug = entry.target.getAttribute(\"data-cat-slug\");\n          if (!slug) return;\n          if (entry.isIntersecting) {\n            setActiveCatSlug(slug);\n          }\n        });\n      },\n      {\n        root: null,\n        rootMargin: \"-80px 0px -60% 0px\",\n        threshold: 0.2,\n      }\n    );\n\n    categoryMap.forEach((cat: any) => {\n      const el = sectionRefs.current[cat.slug];\n      if (el) observer.observe(el);\n    });\n\n    return () => {\n      observer.disconnect();\n    };\n  }, [categoryMap]);\n\n  // Lookup maps for cart totals\n  const [productMap, setProductMap] = useState<Record<number, ProductRow>>({});\n  const [variantMap, setVariantMap] = useState<Record<number, VariantRow>>({});\n\n  useEffect(() => {\n    let alive = true;\n\n    (async () => {\n      const cart = (Array.isArray(items) ? (items as any) : []) as CartItem[];\n      const pids = cart.map((x) => x.productId);\n      const vids = cart.map((x) => x.variantId).filter((v): v is number => v != null);\n\n      try {\n        const [ps, vs] = await Promise.all([getProductsByIds(pids), getVariantsByIds(vids)]);\n        if (!alive) return;\n\n        const pm: Record<number, ProductRow> = {};\n        for (const p of ps) pm[p.id] = p;\n\n        const vm: Record<number, VariantRow> = {};\n        for (const v of vs) vm[v.id] = v;\n\n        setProductMap(pm);\n        setVariantMap(vm);\n      } catch (e) {\n        console.error(e);\n      }\n    })();\n\n    return () => {\n      alive = false;\n    };\n  }, [items]);\n\n  const scrollToCategory = (slug: string) => {\n    const el = sectionRefs.current[slug];\n    if (!el) return;\n\n    // Approximate combined height of TopNavbar + sticky top categories strip\n    const headerOffset = 170; // adjusted for TopNavbar + sticky top categories strip\n\n    const rect = el.getBoundingClientRect();\n    const scrollTop = window.scrollY + rect.top - headerOffset;\n\n    window.scrollTo({\n      top: scrollTop,\n      behavior: \"smooth\",\n    });\n  };\n\n  const cartTotals = useMemo(() => {\n    const cart = (Array.isArray(items) ? (items as any) : []) as CartItem[];\n\n    let total = 0;\n    let count = 0;\n\n    for (const it of cart) {\n      const p = productMap[it.productId];\n      if (!p) continue;\n\n      const v = it.variantId != null ? variantMap[it.variantId] : null;\n      const price = Number(v?.price ?? p.base_price ?? 0);\n\n      total += price * (it.qty ?? 1);\n      count += it.qty ?? 1;\n    }\n\n    return { total, count };\n  }, [items, productMap, variantMap]);\n\n  const cartCtaPrimary = lang === \"en\" ? \"Go to Cart ‚Üí\" : \"U gudub Gaadhiga ‚Üí\";\n\n  return (\n    <main className=\"min-h-screen bg-white text-black\">\n\n      {/* TOP CATEGORIES STRIP (just under search bar) */}\n      {categoryMap.length > 0 && (\n<section className=\"sticky top-[110px] z-40 border-b bg-white shadow-sm\">          <div className=\"mx-auto max-w-md px-2 py-2 flex gap-4 overflow-x-auto\">\n            {categoryMap.map((cat: any) => {\n              const label = lang === \"en\" ? cat.name_en : cat.name_so;\n              const imgSrc =\n                typeof cat.img === \"string\" && cat.img.trim().length > 0\n                  ? cat.img.trimEnd()\n                  : \"/example.png\";\n              const isActive = activeCatSlug === cat.slug;\n\n              return (\n                <button\n                  key={cat.id}\n                  onClick={() => scrollToCategory(cat.slug)}\n                  className={`min-w-[78px] px-1 py-0.5 rounded-xl transition-all duration-200 ${\n                    isActive ? \"bg-[#E3F2FF] shadow-md scale-[1.02]\" : \"bg-transparent\"\n                  }`}\n                  type=\"button\"\n                >\n                  {!compactTopCats && (\n                    <div\n                      className={`mx-auto h-14 w-14 pt-[-10px] ounded-full overflow-hidden flex items-center justify-center transition-shadow ${\n                        isActive\n                          ? \"bg-[#DBEAFE] ring-2 ring-[#0B6EA9] shadow-lg\"\n                          : \"bg-blue-50\"\n                      }`}\n                    >\n                      <Image\n                        src={imgSrc}\n                        alt={label}\n                        width={56}\n                        height={56}\n                        className=\"w-full h-full object-contain p-1\"\n                      />\n                    </div>\n                  )}\n\n                  <div\n                    className={`mt-1 text-[11px] text-center leading-tight font-semibold transition-colors ${\n                      isActive ? \"text-[#0B6EA9]\" : \"text-[#0B3C6E]\"\n                    }`}\n                  >\n                    {label}\n                  </div>\n                </button>\n              );\n            })}\n          </div>\n        </section>\n      )}\n\n      {/* HERO / AD SLIDESHOW */}\n      <section className=\"bg-white pt-0\">\n        <div className=\"relative overflow-hidden rounded-2xl bg-white h-[140px] w-[90%] mx-auto\">\n          <div\n            className=\"flex transition-transform duration-500\"\n            style={{ transform: `translateX(-${activeSlide * 100}%)` }}\n          >\n            {HERO_SLIDES.map((s) => (\n              <div\n                key={s.id}\n                className=\"flex-none w-full h-[140px] flex items-center justify-center bg-white\">\n                <Image\n                  src={s.img}\n                  alt=\"promo\"\n                  width={500}\n                  height={140}\n                  className=\"max-h-full w-full object-contain\"\n                />\n              </div>\n            ))}\n          </div>\n        </div>\n      </section>\n\n      {/* PROMO CARDS ROW - CLEAN SUPERMARKET STYLE */}\n      <section className=\"bg-white px-4 pt-0 -mt-2\">\n        <div className=\"relative\">\n          <div className=\"flex gap-2 overflow-x-auto pb-1 snap-x snap-mandatory\">\n            {[\n              \"https://ecfxrmhrfjqdmqewzrfz.supabase.co/storage/v1/object/public/product-images/ads/bar1.webp\",\n              \"https://ecfxrmhrfjqdmqewzrfz.supabase.co/storage/v1/object/public/product-images/ads/bar2.webp\",\n              \"https://ecfxrmhrfjqdmqewzrfz.supabase.co/storage/v1/object/public/product-images/ads/bar3.webp\",\n              \"https://ecfxrmhrfjqdmqewzrfz.supabase.co/storage/v1/object/public/product-images/ads/bar4.webp\",\n            ].map((url, i) => (\n              <div\n                key={i}\n                className=\"min-w-[100px] h-[140px] rounded-2xl overflow-hidden bg-white shadow-sm flex-shrink-0 snap-start border border-gray-200\"\n              >\n                <Image\n                  src={url}\n                  alt=\"promo\"\n                  width={100}\n                  height={140}\n                  className=\"w-full h-full object-cover\"\n                />\n              </div>\n            ))}\n          </div>\n\n          {/* subtle edge fades */}\n          {/* <div className=\"pointer-events-none absolute inset-y-0 left-0 w-4 bg-gradient-to-r from-white to-transparent\" />\n          <div className=\"pointer-events-none absolute inset-y-0 right-0 w-4 bg-gradient-to-l from-white to-transparent\" /> */}\n        </div>\n      </section>\n\n      {/* CATEGORY SECTIONS */}\n      <section className=\"bg-white px-3 pb-6 pt-1\">\n        {categoryMap.map((cat: any) => {\n          const catPrimary = lang === \"en\" ? cat.name_en : cat.name_so;\n\n          return (\n            <div\n              key={cat.id}\n              ref={(el) => {\n                sectionRefs.current[cat.slug] = el;\n              }}\n              data-cat-slug={cat.slug}\n              className=\"scroll-mt-[140px] pb-3\"\n            >\n              <div className=\"mb-1\">\n                <PrimarySecondary\n                  primary={catPrimary}\n                  center={false}\n                  primaryClass=\"text-lg font-bold text-gray-900\"\n                />\n              </div>\n\n              <div className=\"grid grid-cols-3 gap-x-3 gap-y-2.5\">\n                {(cat.subcats || []).slice(0, 8).map((sub: any) => {\n                  const subPrimary = lang === \"en\" ? sub.name_en : sub.name_so;\n\n                  return (\n                    <Link\n                      key={sub.id}\n                      href={`/subcategory/${sub.slug}`}\n                      className=\"flex flex-col items-center\"\n                    >\n                      <div\n                        className={`relative h-[90px] w-[90px] rounded-2xl overflow-hidden flex items-center justify-center ${getCategoryBg(\n                          cat.slug,\n                        )}`}\n                      >\n                        <Image\n                          src={\n                            typeof sub.img === \"string\" && sub.img.trim().length > 0\n                              ? sub.img.trimEnd()\n                              : \"/example.png\"\n                          }\n                          alt={subPrimary}\n                          fill\n                          className=\"object-contain\"\n                        />\n                      </div>\n\n                      <div className=\"mt-0.5\">\n                        <PrimarySecondary\n                          primary={subPrimary}\n                          primaryClass=\"text-[12px] font-semibold text-gray-800\"\n                        />\n                      </div>\n                    </Link>\n                  );\n                })}\n              </div>\n            </div>\n          );\n        })}\n      </section>\n\n      {/* STICKY GO TO CART BAR */}\n      {cartTotals.count > 0 && (\n        <div className=\"fixed left-0 right-0 bottom-[100px] z-40\">\n          <div className=\"mx-auto max-w-md px-3\">\n            <Link\n              href=\"/cart\"\n              className=\"flex items-center justify-between bg-[#0B6EA9] text-white rounded-2xl px-4 py-3 shadow-lg\"\n            >\n              <div>\n                <div className=\"text-xs opacity-90\">\n                  {cartTotals.count} item{cartTotals.count > 1 ? \"s\" : \"\"} in cart\n                </div>\n                <div className=\"text-lg font-extrabold\">{money(cartTotals.total)}</div>\n              </div>\n\n              <div className=\"text-right leading-tight font-extrabold\">\n                <div>{cartCtaPrimary}</div>\n              </div>\n            </Link>\n          </div>\n        </div>\n      )}\n    </main>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}